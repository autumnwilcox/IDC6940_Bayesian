<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.8.24" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Namita Mishra" />
<meta name="author" content="Autumn Wilcox" />
<meta name="dcterms.date" content="2025-11-10" />

<title>Bayesian Logistic Regression for Predicting Diabetes Risk Using NHANES 2013–2014 Data – Bayesian Logistic Regression Capstone</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>


<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="/index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="/index.html">
    <span class="navbar-title">Bayesian Logistic Regression Capstone</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
  aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation"
  onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="/slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="/about.html"> 
<span class="menu-text">About Us</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayesian Logistic Regression for Predicting Diabetes Risk Using NHANES 2013–2014 Data</h1>
<p class="subtitle lead">A Capstone Project on Bayesian Applications in Epidemiologic Modeling</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Namita Mishra </p>
             <p>Autumn Wilcox </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction">Introduction</a>
  <ul>
  <li><a href="#aims" id="toc-aims">Aims</a></li>
  </ul></li>
  <li><a href="#method" id="toc-method">Method</a>
  <ul>
  <li><a href="#bayesian-logistic-regression" id="toc-bayesian-logistic-regression">Bayesian Logistic Regression</a></li>
  <li><a href="#model-structure" id="toc-model-structure">Model Structure</a></li>
  <li><a href="#prior-specification" id="toc-prior-specification">Prior Specification</a></li>
  <li><a href="#posterior-predictions" id="toc-posterior-predictions">Posterior Predictions</a></li>
  <li><a href="#model-evaluation-and-diagnostics" id="toc-model-evaluation-and-diagnostics">Model Evaluation and Diagnostics</a></li>
  <li><a href="#advantages-of-bayesian-logistic-regression" id="toc-advantages-of-bayesian-logistic-regression">Advantages of Bayesian Logistic Regression</a></li>
  </ul></li>
  <li><a href="#analysis-and-results" id="toc-analysis-and-results">Analysis and Results</a>
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation">Data Preparation</a>
  <ul>
  <li><a href="#data-import-and-merging" id="toc-data-import-and-merging">Data Import and Merging</a></li>
  <li><a href="#variable-definitions" id="toc-variable-definitions">Variable Definitions</a></li>
  <li><a href="#study-design-and-survey-weighted-analysis" id="toc-study-design-and-survey-weighted-analysis">Study Design and Survey-Weighted Analysis</a></li>
  <li><a href="#adult-cohort-definition" id="toc-adult-cohort-definition">Adult Cohort Definition</a></li>
  <li><a href="#missing-data-summary" id="toc-missing-data-summary">Missing Data Summary</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis">Exploratory Data Analysis</a></li>
  </ul></li>
  <li><a href="#modeling-frameworks" id="toc-modeling-frameworks">Modeling Frameworks</a>
  <ul>
  <li><a href="#survey-weighted-logistic-regression-design-based-mle" id="toc-survey-weighted-logistic-regression-design-based-mle">Survey-Weighted Logistic Regression (Design-Based MLE)</a></li>
  <li><a href="#multiple-imputation-by-chained-equations" id="toc-multiple-imputation-by-chained-equations">Multiple Imputation by Chained Equations</a></li>
  <li><a href="#bayesian-logistic-regression-1" id="toc-bayesian-logistic-regression-1">Bayesian Logistic Regression</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results">Results</a>
  <ul>
  <li><a href="#population-level-interpretation-posterior-odds-ratios" id="toc-population-level-interpretation-posterior-odds-ratios">Population-level interpretation (posterior, odds ratios)</a></li>
  </ul></li>
  <li><a href="#discussion-and-limitations" id="toc-discussion-and-limitations">Discussion and Limitations</a>
  <ul>
  <li><a href="#interpretation-2" id="toc-interpretation-2">Interpretation</a></li>
  <li><a href="#limitations" id="toc-limitations">Limitations</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#bibliography" id="toc-bibliography">References</a></li>
  </ul>
</nav>
<p>Slides: <a href="slides.html" target="_blank">slides.html</a> (Edit <code>slides.qmd</code>.)</p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Diabetes mellitus (DM) remains a major public health challenge, and identifying key risk factors—such as obesity, age, sex, and race/ethnicity—is essential for prevention and targeted intervention. Logistic regression is widely used to estimate associations between such factors and binary outcomes like diabetes diagnosis. However, classical maximum likelihood estimation (MLE) can produce unstable estimates in the presence of missing data, quasi-separation, or small samples. Bayesian logistic regression offers a robust alternative by integrating prior information, regularizing estimates, and quantifying uncertainty more transparently than frequentist approaches.</p>
<p>Bayesian hierarchical models, implemented via Markov Chain Monte Carlo (MCMC), have been successfully applied in predicting patient health status across diseases such as pneumonia, prostate cancer, and mental disorders <span class="citation" data-cites="zeger2020">(<a href="#ref-zeger2020" role="doc-biblioref">Zeger et al. 2020</a>)</span>. By representing predictive uncertainty alongside point estimates, Bayesian inference offers a practical advantage in epidemiologic modeling where decisions hinge on probabilistic thresholds. Beyond stability, Bayesian methods support model checking, variable selection, and uncertainty quantification under missingness or imputation frameworks <span class="citation" data-cites="baldwin2017 kruschke2017">(<a href="#ref-baldwin2017" role="doc-biblioref">Baldwin and Larson 2017</a>; <a href="#ref-kruschke2017" role="doc-biblioref">Kruschke and Liddell 2017</a>)</span>.</p>
<p>Recent work has expanded Bayesian applications to disease diagnostics and health risk modeling. For instance, Bayesian approaches have been used to evaluate NHANES diagnostic data <span class="citation" data-cites="chatzimichail2023">(<a href="#ref-chatzimichail2023" role="doc-biblioref">Chatzimichail and Hatjimihail 2023</a>)</span>, to model cardiovascular and metabolic risk <span class="citation" data-cites="liu2013">(<a href="#ref-liu2013" role="doc-biblioref">Liu et al. 2013</a>)</span>, and to integrate multiple data modalities such as imaging and laboratory measures <span class="citation" data-cites="abdullah2022bdlhealth">(<a href="#ref-abdullah2022bdlhealth" role="doc-biblioref">Abdullah, Hassan, and Mustafa 2022</a>)</span>. Moreover, multiple imputation combined with Bayesian modeling generates robust estimates when data are missing at random (MAR) or not at random (MNAR) <span class="citation" data-cites="austin2021">(<a href="#ref-austin2021" role="doc-biblioref">Austin et al. 2021</a>)</span>.</p>
<p>The broader Bayesian literature emphasizes the role of priors and model checking. Weakly informative priors, such as <span class="math inline">\(N(0, 2.5)\)</span> for coefficients, regularize estimation and reduce variance in small samples <span class="citation" data-cites="gelman2008 vandeschoot2021">(<a href="#ref-gelman2008" role="doc-biblioref">Gelman et al. 2008</a>; <a href="#ref-vandeschoot2021" role="doc-biblioref">Vande Schoot et al. 2021</a>)</span>. Tutorials using R packages like <code>brms</code> and <code>blavaan</code> illustrate how MCMC enables posterior inference and empirical Bayes analysis <span class="citation" data-cites="klauenberg2015">(<a href="#ref-klauenberg2015" role="doc-biblioref">Klauenberg et al. 2015</a>)</span>.</p>
<p>Beyond standard generalized linear models, Bayesian nonparametric regression flexibly captures nonlinearity and zero inflation common in health data <span class="citation" data-cites="richardson2018bnr">(<a href="#ref-richardson2018bnr" role="doc-biblioref">Richardson and Hartman 2018</a>)</span>. Bayesian Additive Regression Trees (BART) improve variable selection in mixed-type data <span class="citation" data-cites="luo2024bartvs">(<a href="#ref-luo2024bartvs" role="doc-biblioref">Luo et al. 2024</a>)</span>, while state-space and dynamic Bayesian models incorporate time-varying biomarkers for longitudinal prediction <span class="citation" data-cites="momeni2021covidbayes">(<a href="#ref-momeni2021covidbayes" role="doc-biblioref">Momeni et al. 2021</a>)</span>. Bayesian model averaging (BMA) further addresses model uncertainty by weighting across multiple specifications <span class="citation" data-cites="hoeting1999bma">(<a href="#ref-hoeting1999bma" role="doc-biblioref">Hoeting et al. 1999</a>)</span>. Together, these approaches demonstrate the versatility and growing importance of Bayesian inference in clinical and epidemiologic modeling.</p>
<p>The objective of this project is to evaluate whether Bayesian inference provides more stable and interpretable estimates of diabetes risk than frequentist and imputation-based approaches, particularly when data complexity or separation challenges arise. Agreement across modeling frameworks supports the robustness of these associations and highlights the interpretability and uncertainty quantification advantages offered by Bayesian analysis in population health modeling <span class="citation" data-cites="nchs2014">(<a href="#ref-nchs2014" role="doc-biblioref">National Center for Health Statistics (NCHS) 2014</a>)</span>.</p>
<section id="aims" class="level2">
<h2>Aims</h2>
<p>The present study employs Bayesian logistic regression to predict diabetes status and examine the relationships between diabetes and key predictors, including body mass index (BMI), age (≥20 years), sex, and race. Using retrospective data from the 2013–2014 NHANES survey, the analysis accounts for the study’s complex sampling design, which involves stratification, clustering, and the oversampling of specific subpopulations rather than simple random sampling. The Bayesian framework is applied to address common analytical challenges such as missing data, complete case bias, and data separation, thereby improving the robustness and reliability of inference compared to traditional logistic regression methods.</p>
</section>
</section>
<section id="method" class="level1">
<h1>Method</h1>
<section id="bayesian-logistic-regression" class="level2">
<h2>Bayesian Logistic Regression</h2>
<p>The Bayesian framework integrates prior knowledge with observed data to generate posterior distributions, allowing parameters to be interpreted directly in probabilistic terms.</p>
<p>Unlike traditional frequentist approaches that yield single-point estimates and p-values, Bayesian methods represent parameters as random variables with full probability distributions.</p>
<p>This provides greater flexibility, incorporates parameter uncertainty, and produces credible intervals that directly quantify the probability that a parameter lies within a given range.</p>
</section>
<section id="model-structure" class="level2">
<h2>Model Structure</h2>
<p>Bayesian logistic regression models the log-odds of a binary outcome as a linear combination of predictors:</p>
<p><span class="math display">\[
\text{logit}(P(Y = 1)) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(P(Y = 1)\)</span> is the probability of the event of interest,</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept (log-odds when all predictors are zero), and</li>
<li><span class="math inline">\(\beta_j\)</span> represents the effect of predictor <span class="math inline">\(X_j\)</span> on the log-odds of the outcome, holding other predictors constant.</li>
</ul>
<p>In the Bayesian framework, model parameters (<span class="math inline">\(\boldsymbol{\beta}\)</span>) are treated as random variables and assigned prior distributions that reflect existing knowledge or plausible ranges before observing the data. After incorporating the observed evidence, the priors are updated through Bayes’ theorem <span class="citation" data-cites="deleeuw2012 klauenberg2015">(<a href="#ref-deleeuw2012" role="doc-biblioref">Leeuw and Klugkist 2012</a>; <a href="#ref-klauenberg2015" role="doc-biblioref">Klauenberg et al. 2015</a>)</span>:</p>
<p><span class="math display">\[
\text{Posterior} \propto \text{Likelihood} \times \text{Prior}
\]</span></p>
<ul>
<li><strong>Likelihood:</strong> represents the probability of the observed data given the model parameters—it captures how well different parameter values explain the data.</li>
<li><strong>Prior:</strong> expresses beliefs or existing information about the parameters before observing the data.</li>
<li><strong>Posterior:</strong> combines both, representing the updated distribution of parameter values after accounting for the data.</li>
</ul>
<p>This formulation allows uncertainty to propagate naturally through the model, producing posterior distributions for each coefficient that can be directly interpreted as probabilities.</p>
</section>
<section id="prior-specification" class="level2">
<h2>Prior Specification</h2>
<p>Weakly informative priors were used to regularize estimation without imposing strong assumptions:</p>
<ul>
<li><strong>Regression Coefficients:</strong> <span class="math inline">\(N(0, 2.5)\)</span>, providing gentle regularization while allowing substantial variation in plausible effects <span class="citation" data-cites="gelman2008 vandeschoot2021">(<a href="#ref-gelman2008" role="doc-biblioref">Gelman et al. 2008</a>; <a href="#ref-vandeschoot2021" role="doc-biblioref">Vande Schoot et al. 2021</a>)</span>.</li>
<li><strong>Intercept:</strong> Student’s t-distribution prior, <span class="math inline">\(t(3, 0, 10)\)</span> <span class="citation" data-cites="vandeschoot2013 vandeschoot2021">(<a href="#ref-vandeschoot2013" role="doc-biblioref">Schoot et al. 2013</a>; <a href="#ref-vandeschoot2021" role="doc-biblioref">Vande Schoot et al. 2021</a>)</span>, which has
<ul>
<li>3 degrees of freedom (heavy tails to allow occasional large effects),</li>
<li>mean 0 (no bias toward positive or negative effects), and</li>
<li>scale 10 (broad range of possible values).</li>
</ul></li>
</ul>
<p>Such priors help stabilize estimation in the presence of multicollinearity, limited sample size, or potential outliers.</p>
</section>
<section id="posterior-predictions" class="level2">
<h2>Posterior Predictions</h2>
<p>Posterior distributions of regression coefficients were used to estimate the probability of the outcome for given predictor values. This allows statements such as: &gt; Given the predictors, the probability of the outcome lies between X% and Y%.</p>
<p>Posterior predictions account for two key sources of uncertainty:</p>
<ol type="1">
<li><strong>Parameter Uncertainty:</strong> Variability in estimated model coefficients.</li>
<li><strong>Predictive Uncertainty:</strong> Variability in possible future outcomes given those parameters.</li>
</ol>
<p>In Bayesian analysis, all unknown quantities—coefficients, means, variances, or probabilities—are treated as random variables described by their posterior distributions.</p>
</section>
<section id="model-evaluation-and-diagnostics" class="level2">
<h2>Model Evaluation and Diagnostics</h2>
<p>Model quality and convergence were assessed using standard Bayesian diagnostics:</p>
<ul>
<li><strong>Posterior Sampling:</strong> Conducted via Markov Chain Monte Carlo (MCMC) using the No-U-Turn Sampler (NUTS), a variant of Hamiltonian Monte Carlo (HMC) <span class="citation" data-cites="austin2021">(<a href="#ref-austin2021" role="doc-biblioref">Austin et al. 2021</a>)</span>. Four chains were run with sufficient warm-up iterations to ensure convergence.</li>
<li><strong>Convergence Metrics:</strong> The potential scale reduction factor (<span class="math inline">\(\hat{R}\)</span>) and effective sample size (ESS) were used to verify stability and mixing across chains.</li>
<li><strong>Autocorrelation Checks:</strong> Ensured independence between successive draws.</li>
<li><strong>Posterior Predictive Checks (PPCs):</strong> Compared simulated outcomes to observed data to evaluate fit.</li>
<li><strong>Bayesian</strong> <span class="math inline">\(R^2\)</span>: Quantified the proportion of variance explained by predictors, incorporating posterior uncertainty.</li>
</ul>
</section>
<section id="advantages-of-bayesian-logistic-regression" class="level2">
<h2>Advantages of Bayesian Logistic Regression</h2>
<ul>
<li><strong>Uncertainty Quantification:</strong> Produces full posterior distributions instead of single estimates.</li>
<li><strong>Credible Intervals:</strong> Provide the range within which a parameter lies with a specified probability (e.g., 95%).</li>
<li><strong>Flexible Priors:</strong> Allow integration of expert knowledge or findings from prior studies.</li>
<li><strong>Probabilistic Predictions:</strong> Posterior predictive distributions yield direct probabilities for new or future observations.</li>
<li><strong>Model Evaluation:</strong> PPCs assess how well simulated outcomes reproduce observed data.</li>
</ul>
</section>
</section>
<section id="analysis-and-results" class="level1">
<h1>Analysis and Results</h1>
<section id="data-preparation" class="level2">
<h2>Data Preparation</h2>
<p>This study used publicly available 2013–2014 NHANES data published by the CDC’s National Center for Health Statistics <span class="citation" data-cites="nchs2014">(<a href="#ref-nchs2014" role="doc-biblioref">National Center for Health Statistics (NCHS) 2014</a>)</span>. Three component files were utilized: <code>DEMO_H</code> (demographics), <code>BMX_H</code> (body measures), and <code>DIQ_H</code> (diabetes questionnaire). Each file was imported in <code>.XPT</code> format using the <strong><code>haven</code></strong> package in <strong>R</strong>, and merged using the unique participant identifier <code>SEQN</code> to create a single adult analytic dataset (age ≥ 20 years).</p>
<p>All variables were coerced to consistent numeric or factor types prior to merging to ensure atomic columns suitable for survey-weighted analysis and modeling. The use of <code>SEQN</code> preserved respondent integrity across datasets and ensured accurate record linkage. This preprocessing step standardized variable formats and minimized inconsistencies between files.</p>
<p>Data wrangling, cleaning, and merging were performed in <strong>R</strong> using a combination of base functions and tidyverse packages. Bayesian logistic regression modeling was later implemented using the <strong><code>brms</code></strong> interface to <strong>Stan</strong>, allowing probabilistic inference within a reproducible workflow that accommodated the NHANES complex survey design and missing data considerations.</p>
<section id="data-import-and-merging" class="level3">
<h3>Data Import and Merging</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/merged_2013_2014.rds&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>merged_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(merged_data)</span></code></pre></div>
</details>
</div>
<p>The merged dataset contains 10,175 participants. It integrates demographic, examination, and diabetes questionnaire data. We then restrict the sample to adults (age ≥ 20) to define the analytic cohort used in subsequent analyses. A small proportion of records have missing values in BMI and diabetes status, which will be addressed later through multiple imputation.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<caption>Preview of merged NHANES 2013–2014 dataset limited to analysis variables (source columns only).</caption>
<thead>
<tr class="header">
<th style="text-align: right;">RIDAGEYR</th>
<th style="text-align: right;">BMXBMI</th>
<th style="text-align: right;">RIAGENDR</th>
<th style="text-align: right;">RIDRETH1</th>
<th style="text-align: right;">DIQ010</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">69</td>
<td style="text-align: right;">26.7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">54</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72</td>
<td style="text-align: right;">28.9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">17.1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">73</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">56</td>
<td style="text-align: right;">41.7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">61</td>
<td style="text-align: right;">35.7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">42</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">56</td>
<td style="text-align: right;">26.5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="variable-definitions" class="level3">
<h3>Variable Definitions</h3>
<ul>
<li><p><strong>Response Variable:</strong><br />
<code>diabetes_dx</code> (binary) represents a Type 2 diabetes diagnosis, excluding gestational diabetes. It was derived from <code>DIQ010</code> (“Doctor told you have diabetes”), while <code>DIQ050</code> (insulin use) was excluded to prevent treatment-related confounding.</p></li>
<li><p><strong>Predictor Variables:</strong></p>
<ul>
<li><code>BMXBMI</code> – Body Mass Index (kg/m^2), treated as continuous and categorized into six BMI classes (<code>bmi_cat</code>).<br />
</li>
<li><code>RIDAGEYR</code> – Age (continuous, 20–80 years)<br />
</li>
<li><code>RIAGENDR</code> – Sex (factor, two levels)<br />
</li>
<li><code>RIDRETH1</code> – Ethnicity (factor, five levels)</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>var_tbl <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Variable,   <span class="sc">~</span>Description,                                                                                         <span class="sc">~</span>Type,         <span class="sc">~</span>Origin,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;diabetes_dx&quot;</span>,<span class="st">&quot;Type 2 diabetes diagnosis (1 = Yes, 0 = No) derived from DIQ010; gestational diabetes excluded.&quot;</span>,  <span class="st">&quot;Categorical&quot;</span>, <span class="st">&quot;Derived from DIQ010&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;age&quot;</span>,        <span class="st">&quot;Age in years.&quot;</span>,                                                                                    <span class="st">&quot;Continuous&quot;</span>,  <span class="st">&quot;NHANES RIDAGEYR&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;bmi&quot;</span>,        <span class="st">&quot;Body Mass Index (kg/m^2) computed from measured height and weight.&quot;</span>,                               <span class="st">&quot;Continuous&quot;</span>,  <span class="st">&quot;NHANES BMXBMI&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;bmi_cat&quot;</span>,    <span class="st">&quot;BMI categories: Underweight, Normal, Overweight, Obesity I–III (Normal is reference in models).&quot;</span>,  <span class="st">&quot;Categorical&quot;</span>, <span class="st">&quot;Derived from bmi&quot;</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;sex&quot;</span>,        <span class="st">&quot;Sex of participant (Male, Female).&quot;</span>,                                                               <span class="st">&quot;Categorical&quot;</span>, <span class="st">&quot;NHANES RIAGENDR&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;race&quot;</span>,       <span class="st">&quot;Race/ethnicity collapsed to four levels: White, Black, Hispanic, Other.&quot;</span>,                          <span class="st">&quot;Categorical&quot;</span>, <span class="st">&quot;Derived from RIDRETH1&quot;</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;WTMEC2YR&quot;</span>,   <span class="st">&quot;Examination sample weight for Mobile Examination Center participants.&quot;</span>,                            <span class="st">&quot;Weight&quot;</span>,      <span class="st">&quot;NHANES design&quot;</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SDMVPSU&quot;</span>,    <span class="st">&quot;Primary Sampling Unit used for variance estimation in the complex survey design.&quot;</span>,                 <span class="st">&quot;Design&quot;</span>,      <span class="st">&quot;NHANES design&quot;</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SDMVSTRA&quot;</span>,   <span class="st">&quot;Stratum identifier used to define strata for the complex survey design.&quot;</span>,                          <span class="st">&quot;Design&quot;</span>,      <span class="st">&quot;NHANES design&quot;</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;age_c&quot;</span>,      <span class="st">&quot;Centered and standardized age (z-score).&quot;</span>,                                                         <span class="st">&quot;Continuous&quot;</span>,  <span class="st">&quot;Derived from age&quot;</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;bmi_c&quot;</span>,      <span class="st">&quot;Centered and standardized BMI (z-score).&quot;</span>,                                                         <span class="st">&quot;Continuous&quot;</span>,  <span class="st">&quot;Derived from bmi&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  var_tbl,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Variable Descriptions: Adult Analytic Dataset&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;l&quot;</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">TRUE</span>   <span class="co"># or just remove this line, TRUE is the default</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>,<span class="st">&quot;hover&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">&quot;Analysis variables&quot;</span>, <span class="dv">1</span>, <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">&quot;Survey design variables&quot;</span>, <span class="dv">7</span>, <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">&quot;Derived variables&quot;</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Variable Descriptions: Adult Analytic Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="6">
<td colspan="4" style="border-bottom: 1px solid"><strong>Analysis variables</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">diabetes_dx</td>
<td style="text-align: left;">Type 2 diabetes diagnosis (1 = Yes, 0 = No) derived from DIQ010; gestational diabetes excluded.</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Derived from DIQ010</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">age</td>
<td style="text-align: left;">Age in years.</td>
<td style="text-align: left;">Continuous</td>
<td style="text-align: left;">NHANES RIDAGEYR</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">bmi</td>
<td style="text-align: left;">Body Mass Index (kg/m^2) computed from measured height and weight.</td>
<td style="text-align: left;">Continuous</td>
<td style="text-align: left;">NHANES BMXBMI</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">bmi_cat</td>
<td style="text-align: left;">BMI categories: Underweight, Normal, Overweight, Obesity I–III (Normal is reference in models).</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Derived from bmi</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">sex</td>
<td style="text-align: left;">Sex of participant (Male, Female).</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">NHANES RIAGENDR</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">race</td>
<td style="text-align: left;">Race/ethnicity collapsed to four levels: White, Black, Hispanic, Other.</td>
<td style="text-align: left;">Categorical</td>
<td style="text-align: left;">Derived from RIDRETH1</td>
</tr>
<tr class="even" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>Survey design variables</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">WTMEC2YR</td>
<td style="text-align: left;">Examination sample weight for Mobile Examination Center participants.</td>
<td style="text-align: left;">Weight</td>
<td style="text-align: left;">NHANES design</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SDMVPSU</td>
<td style="text-align: left;">Primary Sampling Unit used for variance estimation in the complex survey design.</td>
<td style="text-align: left;">Design</td>
<td style="text-align: left;">NHANES design</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SDMVSTRA</td>
<td style="text-align: left;">Stratum identifier used to define strata for the complex survey design.</td>
<td style="text-align: left;">Design</td>
<td style="text-align: left;">NHANES design</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="4" style="border-bottom: 1px solid"><strong>Derived variables</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">age_c</td>
<td style="text-align: left;">Centered and standardized age (z-score).</td>
<td style="text-align: left;">Continuous</td>
<td style="text-align: left;">Derived from age</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">bmi_c</td>
<td style="text-align: left;">Centered and standardized BMI (z-score).</td>
<td style="text-align: left;">Continuous</td>
<td style="text-align: left;">Derived from bmi</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="study-design-and-survey-weighted-analysis" class="level3">
<h3>Study Design and Survey-Weighted Analysis</h3>
<p>The National Health and Nutrition Examination Survey (NHANES) employs a complex, multistage probability sampling design with stratification, clustering, and oversampling of specific demographic groups (for example, racial/ethnic minorities and older adults) to produce nationally representative estimates of the U.S. population.</p>
<p>Survey design variables — primary sampling units (<code>SDMVPSU</code>), strata (<code>SDMVSTRA</code>), and examination sample weights (<code>WTMEC2YR</code>) — were retained to account for this complex design. These variables were applied to adjust for unequal probabilities of selection, nonresponse, and oversampling, ensuring valid standard errors, unbiased prevalence estimates, and generalizable population-level inference.</p>
<p>A survey-weighted logistic regression model was used to evaluate the association between diabetes status (<code>diabetes_dx</code>, binary outcome) and key predictors: body mass index (<code>bmi</code>), age (<code>age</code>), sex (<code>sex</code>), and race/ethnicity (<code>race</code>). Diabetes was defined using <code>DIQ010</code> (“Doctor told you have diabetes”) and coded as 0/1, with <code>DIQ050</code> (insulin use) excluded to avoid treatment-related confounding.</p>
<p>Covariates included:<br />
- <code>age</code> (continuous; centered as <code>age_c</code>, categorized 20–80 years)<br />
- <code>bmi</code> (continuous; centered as <code>bmi_c</code>, and categorized by BMI class <code>bmi_cat</code>)<br />
- <code>sex</code> (male, female)<br />
- <code>race</code> (four ethnicity levels: White, Black, Hispanic, Other)</p>
<p>This approach accounts for NHANES’ complex sampling design, producing unbiased parameter estimates and valid inference for U.S. adults.</p>
<table class="caption-top">
<colgroup>
<col style="width: 33%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Weighting</strong></td>
<td>Used the <strong><code>survey</code></strong> package to calculate weighted means for key variables (e.g., age and diabetes status) and to estimate design effects and effective sample size for the complex survey design.</td>
</tr>
<tr class="even">
<td><strong>Standardization</strong></td>
<td>Centered and standardized BMI and age (<code>bmi_c</code>, <code>age_c</code>) for use in regression models.</td>
</tr>
<tr class="odd">
<td><strong>Age Categorization</strong></td>
<td>Not implemented in the analytic dataset (continuous <code>age</code> retained). Reference retained for potential descriptive grouping (20–&lt;30, 30–&lt;40, 40–&lt;50, 50–&lt;60, 60–&lt;70, 70–80).</td>
</tr>
<tr class="even">
<td><strong>BMI Categorization</strong></td>
<td>Recoded as: &lt;18.5 (Underweight), 18.5–&lt;25 (Normal), 25–&lt;30 (Overweight), 30–&lt;35 (Obesity I), 35–&lt;40 (Obesity II), ≥40 (Obesity III).</td>
</tr>
<tr class="odd">
<td><strong>Ethnicity Recoding</strong></td>
<td><code>RIDRETH1</code> recoded as: 1 = Mexican American, 2 = Other Hispanic, 3 = Non-Hispanic White, 4 = Non-Hispanic Black, 5 = Other/Multi; then <code>NH White</code> set as the reference level (five analytical levels retained).</td>
</tr>
<tr class="even">
<td><strong>Special Codes</strong></td>
<td>Transformed nonresponse codes (e.g., 3, 7, 9) to <code>NA</code>. These missing codes were evaluated for potential nonrandom patterns (MAR/MNAR).</td>
</tr>
<tr class="odd">
<td><strong>Missing Data</strong></td>
<td>Retained and visualized missing values (primarily in BMI and diabetes status) to assess their pattern and informativeness before multiple imputation.</td>
</tr>
<tr class="even">
<td><strong>Final Dataset</strong></td>
<td>Created the cleaned analytic dataset (<code>adult</code>) using <em>Non-Hispanic White</em> and <em>Male</em> as reference groups for modeling, preserving NHANES survey design variables (<code>WTMEC2YR</code>, <code>SDMVPSU</code>, <code>SDMVSTRA</code>).</td>
</tr>
</tbody>
</table>
</section>
<section id="adult-cohort-definition" class="level3">
<h3>Adult Cohort Definition</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NHANES survey design object for the adult analytic cohort</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>nhanes_design_adult <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">id      =</span> <span class="sc">~</span>SDMVPSU,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">strata  =</span> <span class="sc">~</span>SDMVSTRA,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">weights =</span> <span class="sc">~</span>WTMEC2YR,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">nest    =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">data    =</span> adult</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick weighted checks</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">::</span><span class="fu">svymean</span>(<span class="sc">~</span>age, nhanes_design_adult, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      mean     SE
age 47.496 0.3805</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">::</span><span class="fu">svymean</span>(<span class="sc">~</span>diabetes_dx, nhanes_design_adult, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                mean     SE
diabetes_dx 0.089016 0.0048</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Design effect and effective sample size for `diabetes_dx`</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>v_hat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(survey<span class="sc">::</span><span class="fu">svyvar</span>(<span class="sc">~</span>diabetes_dx, nhanes_design_adult, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(adult<span class="sc">$</span>diabetes_dx, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(adult)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>v_srs <span class="ot">&lt;-</span> p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat) <span class="sc">/</span> n_obs</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>deff  <span class="ot">&lt;-</span> v_hat <span class="sc">/</span> v_srs</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">weights</span>(nhanes_design_adult), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>ess     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(n_total <span class="sc">/</span> deff)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Design effect for diabetes_dx:&quot;</span>, <span class="fu">round</span>(deff, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Design effect for diabetes_dx: 4759.91 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Effective sample size for diabetes_dx:&quot;</span>, <span class="fu">round</span>(ess), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Effective sample size for diabetes_dx: 48142 </code></pre>
</div>
</div>
<p>Descriptive statistics for continuous and categorical variables are presented below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only analytic variables for Table 1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tbl1_dat <span class="ot">&lt;-</span> adult <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    bmi,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    bmi_cat,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    race,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes_dx =</span> <span class="fu">factor</span>(diabetes_dx, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous summaries: N, missing, mean, sd, min, max</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>cont_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;bmi&quot;</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>cont_sum <span class="ot">&lt;-</span> tbl1_dat <span class="sc">%&gt;%</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(cont_vars)) <span class="sc">%&gt;%</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">N       =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(value)),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean    =</span> <span class="fu">round</span>(<span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD      =</span> <span class="fu">round</span>(<span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min     =</span> <span class="fu">round</span>(<span class="fu">min</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max     =</span> <span class="fu">round</span>(<span class="fu">max</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorical summaries: counts and percents</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;diabetes_dx&quot;</span>, <span class="st">&quot;bmi_cat&quot;</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>cat_sum <span class="ot">&lt;-</span> tbl1_dat <span class="sc">%&gt;%</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(cat_vars),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> forcats<span class="sc">::</span><span class="fu">fct_explicit_na</span>(<span class="fu">as.factor</span>(.x), <span class="at">na_level =</span> <span class="st">&quot;(Missing)&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(cat_vars)) <span class="sc">%&gt;%</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Level&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Variable, Level, <span class="at">name =</span> <span class="st">&quot;n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable) <span class="sc">%&gt;%</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Variable, <span class="fu">desc</span>(n))</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Render tables</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cont_sum,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Table 1a. Continuous variables (age, BMI): N, missing, mean (SD), range.&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Table 1a. Continuous variables (age, BMI): N, missing, mean (SD), range.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">5769</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">49.11</td>
<td style="text-align: right;">17.56</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">80.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">bmi</td>
<td style="text-align: right;">5520</td>
<td style="text-align: right;">249</td>
<td style="text-align: right;">29.10</td>
<td style="text-align: right;">7.15</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">82.9</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cat_sum,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Table 1b. Categorical variables (sex, race, diabetes_dx, bmi_cat): counts and percentages.&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Table 1b. Categorical variables (sex, race, diabetes_dx, bmi_cat): counts and percentages.</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Level</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">25–&lt;30</td>
<td style="text-align: right;">1768</td>
<td style="text-align: right;">30.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">18.5–&lt;25</td>
<td style="text-align: right;">1579</td>
<td style="text-align: right;">27.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">30–&lt;35</td>
<td style="text-align: right;">1145</td>
<td style="text-align: right;">19.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">35–&lt;40</td>
<td style="text-align: right;">519</td>
<td style="text-align: right;">9.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">≥40</td>
<td style="text-align: right;">419</td>
<td style="text-align: right;">7.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">(Missing)</td>
<td style="text-align: right;">249</td>
<td style="text-align: right;">4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi_cat</td>
<td style="text-align: left;">&lt;18.5</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">1.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">diabetes_dx</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">4974</td>
<td style="text-align: right;">86.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diabetes_dx</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">618</td>
<td style="text-align: right;">10.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">diabetes_dx</td>
<td style="text-align: left;">(Missing)</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">3.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race</td>
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">2472</td>
<td style="text-align: right;">42.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: left;">NH Black</td>
<td style="text-align: right;">1177</td>
<td style="text-align: right;">20.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race</td>
<td style="text-align: left;">Other/Multi</td>
<td style="text-align: right;">845</td>
<td style="text-align: right;">14.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: left;">Mexican American</td>
<td style="text-align: right;">767</td>
<td style="text-align: right;">13.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race</td>
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: right;">508</td>
<td style="text-align: right;">8.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">3011</td>
<td style="text-align: right;">52.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">2758</td>
<td style="text-align: right;">47.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Table 1a and 1b summarize the analytic variables included in subsequent models. Mean age and BMI values indicate an adult cohort spanning a wide range of body composition, while categorical summaries confirm balanced sex representation and sufficient sample sizes across race/ethnicity categories. These variables were standardized and used as predictors in all modeling frameworks (analytic cohort N = 5,769 adults ≥ 20 years).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>adult_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(adult)</span></code></pre></div>
</details>
</div>
<div class="cell">
<div id="tbl-adult" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-adult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1: Excerpt of the cleaned NHANES 2013–2014 adult cohort (age ≥ 20; N = 5,769) with derived and standardized variables.
</figcaption>
<div aria-describedby="tbl-adult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top" style="width:100%;">
<colgroup>
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 4%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 15%" />
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">SDMVPSU</th>
<th style="text-align: right;">SDMVSTRA</th>
<th style="text-align: right;">WTMEC2YR</th>
<th style="text-align: right;">diabetes_dx</th>
<th style="text-align: right;">bmi</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">race</th>
<th style="text-align: right;">DIQ050</th>
<th style="text-align: right;">age_c</th>
<th style="text-align: right;">bmi_c</th>
<th style="text-align: left;">bmi_cat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">13481.04</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">26.7</td>
<td style="text-align: right;">69</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NH Black</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.1324183</td>
<td style="text-align: right;">-0.3358861</td>
<td style="text-align: left;">25–&lt;30</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">24471.77</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.6</td>
<td style="text-align: right;">54</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.2783598</td>
<td style="text-align: right;">-0.0702810</td>
<td style="text-align: left;">25–&lt;30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">57193.29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.9</td>
<td style="text-align: right;">72</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.3032300</td>
<td style="text-align: right;">-0.0283434</td>
<td style="text-align: left;">25–&lt;30</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">65541.87</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">73</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.3601672</td>
<td style="text-align: right;">-1.3144311</td>
<td style="text-align: left;">18.5–&lt;25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">111</td>
<td style="text-align: right;">25344.99</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">41.7</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Mexican American</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.3922343</td>
<td style="text-align: right;">1.7609961</td>
<td style="text-align: left;">≥40</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">61758.65</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">35.7</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.6769204</td>
<td style="text-align: right;">0.9222432</td>
<td style="text-align: left;">35–&lt;40</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As shown in <a href="#tbl-adult" class="quarto-xref">Table 1</a>, the analytic adult cohort (N = 5,769) includes standardized variables for age and BMI (<code>age_c</code>, <code>bmi_c</code>), categorical indicators for sex and race/ethnicity (<code>race</code>), and a binary doctor-diagnosed diabetes variable (<code>diabetes_dx</code>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Textual structure and preview</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(adult)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&#39;data.frame&#39;:   5769 obs. of  12 variables:
 $ SDMVPSU    : num  1 1 1 2 1 1 2 1 2 2 ...
 $ SDMVSTRA   : num  112 108 109 116 111 114 106 112 112 113 ...
 $ WTMEC2YR   : num  13481 24472 57193 65542 25345 ...
 $ diabetes_dx: num  1 1 1 0 0 0 0 0 0 0 ...
 $ bmi        : num  26.7 28.6 28.9 19.7 41.7 35.7 NA 26.5 22 20.3 ...
 $ age        : num  69 54 72 73 56 61 42 56 65 26 ...
 $ sex        : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 1 1 1 2 1 2 1 2 1 2 ...
 $ race       : Factor w/ 5 levels &quot;NH White&quot;,&quot;Mexican American&quot;,..: 4 1 1 1 2 1 3 1 1 1 ...
 $ DIQ050     : num  1 1 1 2 2 2 2 2 2 2 ...
 $ age_c      : num  1.132 0.278 1.303 1.36 0.392 ...
 $ bmi_c      : num  -0.3359 -0.0703 -0.0283 -1.3144 1.761 ...
 $ bmi_cat    : Factor w/ 6 levels &quot;&lt;18.5&quot;,&quot;18.5–&lt;25&quot;,..: 3 3 3 2 6 5 NA 3 2 2 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual structure and type overview</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(adult, <span class="at">title =</span> <span class="st">&quot;Adult Dataset: Variable Types and Completeness&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/structure-and-preview-1.png" class="img-fluid" width="672" /></p>
<figcaption>The visual overview indicates that 75% of variables are continuous and 25% are categorical, with no completely missing columns. Approximately 92.7% of rows are fully complete, and only 1.3% of observations contain missing values, suggesting minimal data loss prior to imputation.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="missing-data-summary" class="level3">
<h3>Missing Data Summary</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing data pattern</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(adult, <span class="at">title =</span> <span class="st">&quot;Missing Data Pattern (Adult Dataset)&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/missingness-visual-1.png" class="img-fluid" width="672" /></p>
<figcaption>Missing data were minimal across analytic variables. BMI-related fields (bmi, bmi_c, bmi_cat) showed ~4.3% missingness, and diabetes_dx showed ~3.1%. All demographic and survey design variables were complete, indicating that missingness was limited to health-related measures and appropriate for multiple imputation.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize missingness for key analysis variables</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>miss_tbl <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">Variable    =</span> <span class="fu">c</span>(<span class="st">&quot;bmi&quot;</span>, <span class="st">&quot;diabetes_dx&quot;</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">Missing_n   =</span> <span class="fu">c</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(adult_eda<span class="sc">$</span>bmi)), <span class="fu">sum</span>(<span class="fu">is.na</span>(adult_eda<span class="sc">$</span>diabetes_dx))),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="at">Missing_pct =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(<span class="fu">is.na</span>(adult_eda<span class="sc">$</span>bmi)), <span class="fu">mean</span>(<span class="fu">is.na</span>(adult_eda<span class="sc">$</span>diabetes_dx))) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>miss_tbl,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">&quot;Missingness for Key Analysis Variables.&quot;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Missingness for Key Analysis Variables.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Missing_n</th>
<th style="text-align: right;">Missing_pct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bmi</td>
<td style="text-align: right;">249</td>
<td style="text-align: right;">4.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">diabetes_dx</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">3.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Overall missingness was low (~7.3%). Gaps were concentrated in <code>bmi</code> (n = 249) and <code>diabetes_dx</code> (n = 177), while demographic and design variables were complete. This limited pattern of missingness is consistent with a Missing At Random (MAR) mechanism and likely reflects reduced participation in the physical examination component among certain adults.</p>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3>Exploratory Data Analysis</h3>
<p>Following the missing data assessment, exploratory analyses were conducted to describe the adult analytic cohort and visualize distributions across key demographic and health variables. The goal was to examine univariate patterns and bivariate relationships relevant to diabetes prevalence prior to modeling.</p>
<p>The adult analytic cohort was broadly representative of the U.S. population, with a majority identifying as <code>Non-Hispanic White</code>. <code>Age</code> and <code>BMI</code> distributions were right-skewed, with most participants classified as overweight or obese. Visual exploration revealed a clear positive association between <code>age</code>, <code>BMI</code>, and diabetes prevalence. <code>Non-Hispanic Black</code> and <code>Hispanic</code> participants exhibited higher diabetes prevalence compared with <code>Non-Hispanic Whites</code>.</p>
<p>Approximately 25% of variables were categorical (e.g., <code>sex</code>, <code>race</code>, <code>diabetes_dx</code>) and 75% were continuous (e.g., <code>age</code>, <code>bmi</code>, <code>age_c</code>, <code>bmi_c</code>), indicating that the dataset primarily comprised measured numeric values. About 93% of observations contained complete information across all predictors and outcomes, reflecting high data quality.</p>
<p>Adult <code>age</code> ranged from 20 to 80 years, with peak representation between 30 and 50 years and a slight right skew toward older ages. <code>BMI</code> was concentrated in the overweight and obese ranges, and <code>Female</code> participants were slightly overrepresented relative to <code>Male</code> participants.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age distribution (analytic adult)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Age (≥20 years)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/eda-age-distribution-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of age among adults aged ≥20 years. The sample spans 20–80 years, with peak representation between 30 and 50 years and a gradual decline in older age groups, reflecting a balanced adult cohort suitable for regression modeling.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diabetes outcome distribution</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(diabetes_dx, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Diabetes Outcome Distribution (≥20 years)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Diabetes (No/Yes)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/eda-diabetes-distribution-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of diabetes outcomes among adults aged ≥20 years. Most participants reported no diabetes diagnosis (<code>No</code>), while approximately 11% had diabetes (<code>Yes</code>) and 3% had missing responses, reflecting expected population prevalence and limited outcome missingness.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI category distribution</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(<span class="at">x =</span> bmi_cat)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of BMI Categories (≥20 years)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;BMI Category&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/eda-bmi-distribution-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of BMI categories among adults aged ≥20 years. The majority of participants fell within the overweight (25–&lt;30) and obese (≥30) ranges, with fewer individuals classified as underweight (&lt;18.5). This distribution aligns with national trends in adult body composition, supporting the dataset’s representativeness for metabolic health analyses.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI by diabetes outcome (boxplot)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (You can’t use boxplot with categorical y, so revert to numeric BMI here)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(diabetes_dx, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>)), <span class="at">y =</span> bmi)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;BMI by Diabetes Diagnosis (≥20 years)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Diabetes (No/Yes)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;BMI (numeric)&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/eda-bmi-by-diabetes-outcome-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of BMI by diabetes diagnosis among adults aged ≥20 years. Participants with diabetes (<code>Yes</code>) show a higher median BMI and greater variability compared to those without diabetes (<code>No</code>), supporting the established positive association between obesity and diabetes risk.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diabetes by race (dodged bars)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(<span class="at">x =</span> race, <span class="at">fill =</span> <span class="fu">factor</span>(diabetes_dx, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>)))) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Diabetes Diagnosis by race/Ethnicity (≥20 years)&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;race/Ethnicity (race)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Diabetes&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/eda-diabetes-by-race-1.png" class="img-fluid" width="672" /></p>
<figcaption>Diabetes diagnosis by race/ethnicity among adults aged ≥20 years. Non-Hispanic Black and Hispanic participants show higher proportions of diabetes diagnoses compared with Non-Hispanic White participants, reflecting known disparities in diabetes prevalence across racial and ethnic groups.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modeling-frameworks" class="level2">
<h2>Modeling Frameworks</h2>
<p>Three modeling frameworks were compared using identical predictors—standardized age, BMI, sex, and race—and the binary outcome <code>diabetes_dx</code>:</p>
<ol type="1">
<li><p>survey-weighted logistic regression to account for the NHANES complex sampling design,</p></li>
<li><p>multiple imputation (MICE) to handle missing BMI values, and</p></li>
<li><p>Bayesian logistic regression with weakly informative priors to quantify parameter uncertainty.</p></li>
</ol>
<section id="survey-weighted-logistic-regression-design-based-mle" class="level3">
<h3>Survey-Weighted Logistic Regression (Design-Based MLE)</h3>
<p>The NHANES 2013–2014 data use a complex, multistage probability design involving strata (<code>SDMVSTRA</code>), primary sampling units (PSUs; <code>SDMVPSU</code>), and examination weights (<code>WTMEC2YR</code>) to ensure nationally representative estimates <span class="citation" data-cites="nchs2014">(<a href="#ref-nchs2014" role="doc-biblioref">National Center for Health Statistics (NCHS) 2014</a>)</span>.</p>
<p>Estimates are population-weighted using NHANES survey design variables (<code>WTMEC2YR</code>, <code>SDMVSTRA</code>, <code>SDMVPSU</code>). Odds ratios are reported per one standard deviation (1 SD) increase in age and BMI, with reference groups Male and White.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>adult_clean <span class="ot">&lt;-</span> adult <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex   =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(sex),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(race),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_c =</span> <span class="fu">as.numeric</span>(age_c),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_c =</span> <span class="fu">as.numeric</span>(bmi_c)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(diabetes_dx),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(age_c),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(bmi_c),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(sex),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(race)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</details>
</div>
<p>Below is a structure of the analytic dataset used for regression modeling, showing variable names, types, and sample values (N = 5,349).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(adult_clean[, <span class="fu">c</span>(<span class="st">&quot;diabetes_dx&quot;</span>,<span class="st">&quot;sex&quot;</span>,<span class="st">&quot;race&quot;</span>,<span class="st">&quot;age_c&quot;</span>,<span class="st">&quot;bmi_c&quot;</span>)])</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&#39;data.frame&#39;:   5349 obs. of  5 variables:
 $ diabetes_dx: num  1 1 1 0 0 0 0 0 0 1 ...
 $ sex        : Factor w/ 2 levels &quot;Male&quot;,&quot;Female&quot;: 1 1 1 2 1 2 2 1 2 1 ...
 $ race       : Factor w/ 5 levels &quot;NH White&quot;,&quot;Mexican American&quot;,..: 4 1 1 1 2 1 1 1 1 1 ...
 $ age_c      : num  1.132 0.278 1.303 1.36 0.392 ...
 $ bmi_c      : num  -0.3359 -0.0703 -0.0283 -1.3144 1.761 ...</code></pre>
</div>
</div>
<div class="cell" data-tbl-cap="Distribution of participants by sex (Male = 2,551; Female = 2,798) in the analytic cohort.">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(adult_clean<span class="sc">$</span>sex)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Distribution of participants by sex (Male = 2,551; Female = 2,798) in the analytic cohort.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Var1</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">2551</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">2798</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-tbl-cap="Race/ethnicity composition of the analytic cohort, with most participants identifying as Non-Hispanic White (n = 2,293) and Non-Hispanic Black (n = 1,101).">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(adult_clean<span class="sc">$</span>race)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Race/ethnicity composition of the analytic cohort, with most participants identifying as Non-Hispanic White (n = 2,293) and Non-Hispanic Black (n = 1,101).</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Var1</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NH White</td>
<td style="text-align: right;">2293</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mexican American</td>
<td style="text-align: right;">713</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other Hispanic</td>
<td style="text-align: right;">470</td>
</tr>
<tr class="even">
<td style="text-align: left;">NH Black</td>
<td style="text-align: right;">1101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other/Multi</td>
<td style="text-align: right;">772</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-tbl-cap="Observed diabetes prevalence (binary outcome variable `diabetes_dx`), with 597 diagnosed cases (1 = Yes) and 4,752 non-diabetic participants (0 = No).">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(adult_clean<span class="sc">$</span>diabetes_dx)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Observed diabetes prevalence (binary outcome variable <code>diabetes_dx</code>), with 597 diagnosed cases (1 = Yes) and 4,752 non-diabetic participants (0 = No).</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Var1</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">4752</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">597</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>nhanes_design_adult <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id      =</span> <span class="sc">~</span>SDMVPSU,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata  =</span> <span class="sc">~</span>SDMVSTRA,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>WTMEC2YR,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nest    =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> adult_clean</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>svy_fit <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svyglm</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  diabetes_dx <span class="sc">~</span> age_c <span class="sc">+</span> bmi_c <span class="sc">+</span> sex <span class="sc">+</span> race,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> nhanes_design_adult,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">quasibinomial</span>()</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>svy_or <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(svy_fit, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR  =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">LCL =</span> <span class="fu">exp</span>(conf.low),</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">UCL =</span> <span class="fu">exp</span>(conf.high)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(term, OR, LCL, UCL, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(svy_or)</span></code></pre></div>
</details>
<div id="tbl-svylogit" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-svylogit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 2: Survey-weighted logistic regression: odds ratios (OR) and 95% confidence intervals for diabetes diagnosis among adults (NHANES 2013–2014).
</figcaption>
<div aria-describedby="tbl-svylogit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">OR</th>
<th style="text-align: right;">LCL</th>
<th style="text-align: right;">UCL</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age_c</td>
<td style="text-align: right;">3.0292807</td>
<td style="text-align: right;">2.6967690</td>
<td style="text-align: right;">3.4027912</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">bmi_c</td>
<td style="text-align: right;">1.8853571</td>
<td style="text-align: right;">1.6526296</td>
<td style="text-align: right;">2.1508579</td>
<td style="text-align: right;">0.0000039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexFemale</td>
<td style="text-align: right;">0.5281132</td>
<td style="text-align: right;">0.4104905</td>
<td style="text-align: right;">0.6794397</td>
<td style="text-align: right;">0.0003857</td>
</tr>
<tr class="even">
<td style="text-align: left;">raceMexican American</td>
<td style="text-align: right;">2.0358434</td>
<td style="text-align: right;">1.4850041</td>
<td style="text-align: right;">2.7910081</td>
<td style="text-align: right;">0.0008262</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raceOther Hispanic</td>
<td style="text-align: right;">1.5915182</td>
<td style="text-align: right;">1.1664529</td>
<td style="text-align: right;">2.1714810</td>
<td style="text-align: right;">0.0087119</td>
</tr>
<tr class="even">
<td style="text-align: left;">raceNH Black</td>
<td style="text-align: right;">1.6689718</td>
<td style="text-align: right;">1.1605895</td>
<td style="text-align: right;">2.4000450</td>
<td style="text-align: right;">0.0116773</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raceOther/Multi</td>
<td style="text-align: right;">2.3270527</td>
<td style="text-align: right;">1.5451752</td>
<td style="text-align: right;">3.5045697</td>
<td style="text-align: right;">0.0014331</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<section id="interpretation" class="level4">
<h4>Interpretation</h4>
<p><code>age_c</code> and <code>bmi_c</code> are the strongest predictors of diabetes in the NHANES 2013–2014 adult cohort, with each 1 SD increase in age nearly tripling the odds of diabetes and higher BMI substantially elevating risk. Males show significantly lower odds of diabetes than females, consistent with established sex differences in metabolic outcomes. Racial and ethnic disparities are evident, with Mexican American, Other Hispanic, Non-Hispanic Black, and Other/Multi-racial adults all showing significantly higher odds of diabetes compared to Non-Hispanic Whites. All predictors were statistically significant (p &lt; 0.05), indicating robust associations across demographic and health characteristics.</p>
</section>
</section>
<section id="multiple-imputation-by-chained-equations" class="level3">
<h3>Multiple Imputation by Chained Equations</h3>
<p>Multiple Imputation by Chained Equations (<code>MICE</code>) was implemented as a principled approach for handling missing data <span class="citation" data-cites="vanbuuren2011 vanbuuren2012">(<a href="#ref-vanbuuren2011" role="doc-biblioref">Stef van Buuren and Groothuis-Oudshoorn 2011</a>; <a href="#ref-vanbuuren2012" role="doc-biblioref">S. van Buuren 2012</a>)</span>. <code>MICE</code> iteratively imputes each incomplete variable using regression models based on other variables in the dataset, generating multiple completed datasets that incorporate uncertainty from the imputation process. Estimates are subsequently pooled across imputations using Rubin’s rules to obtain final parameter estimates and confidence intervals.</p>
<p>As an alternative to full Bayesian joint modeling, <code>MICE</code> provides an efficient and flexible framework for managing missing data through chained regression equations. For large sample sizes (<code>n ≥ 400</code>), even with substantial missingness (up to 75%) in a single variable, <code>MICE</code> remains robust to non-normality—such as skewed, multimodal, or heavy-tailed distributions—without materially affecting mean structure estimation performance <span class="citation" data-cites="vanbuuren2012">(<a href="#ref-vanbuuren2012" role="doc-biblioref">S. van Buuren 2012</a>)</span>.</p>
<p>In this study, continuous variables were imputed using regression-based methods: <code>age</code> via normal linear regression (<code>norm</code>) and <code>BMI</code> via predictive mean matching (<code>pmm</code>) to better preserve the empirical BMI distribution. Categorical variables (<code>sex</code> and <code>race</code>) were imputed using logistic and polytomous regression models, respectively. Diabetes status (<code>diabetes_dx</code>) was treated as an outcome variable and was <strong>not</strong> imputed. Twenty imputations were generated to minimize Monte Carlo error and ensure stable variance estimation.</p>
<section id="convergence-and-data-stability" class="level4">
<h4>Convergence and Data Stability</h4>
<p>The chained equation process showed stable convergence across iterations, confirming reliable estimation of missing <code>BMI</code> (and, where present, <code>age</code>) values. After applying <code>MICE</code>, the final imputed dataset included <strong>n = 5,592 adults</strong> with all key predictors completed.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>adult_imp1 <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(imp, <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_c  =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(age)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_c  =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(bmi)),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt_norm =</span> WTMEC2YR <span class="sc">/</span> <span class="fu">mean</span>(WTMEC2YR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(race, <span class="st">&quot;NH White&quot;</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex  =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(sex,  <span class="st">&quot;Male&quot;</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(diabetes_dx),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(age_c),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(bmi_c),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(sex),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(race)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(adult_imp1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,592
Columns: 11
$ diabetes_dx &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ age         &lt;dbl&gt; 69, 54, 72, 73, 56, 61, 42, 56, 65, 26, 76, 33, 32, 38, 50…
$ bmi         &lt;dbl&gt; 26.7, 28.6, 28.9, 19.7, 41.7, 35.7, 23.6, 26.5, 22.0, 20.3…
$ sex         &lt;fct&gt; Male, Male, Male, Female, Male, Female, Male, Female, Male…
$ race        &lt;fct&gt; NH Black, NH White, NH White, NH White, Mexican American, …
$ WTMEC2YR    &lt;dbl&gt; 13481.04, 24471.77, 57193.29, 65541.87, 25344.99, 61758.65…
$ SDMVPSU     &lt;dbl&gt; 1, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2…
$ SDMVSTRA    &lt;dbl&gt; 112, 108, 109, 116, 111, 114, 106, 112, 112, 113, 116, 114…
$ age_c       &lt;dbl&gt; 1.13241831, 0.27835981, 1.30323001, 1.36016725, 0.39223428…
$ bmi_c       &lt;dbl&gt; -0.33319172, -0.06755778, -0.02561558, -1.31184309, 1.7639…
$ wt_norm     &lt;dbl&gt; 0.3393916, 0.6160884, 1.4398681, 1.6500477, 0.6380722, 1.5…</code></pre>
</div>
</div>
</section>
<section id="descriptive-results-imputed-dataset" class="level4">
<h4>Descriptive Results (Imputed Dataset)</h4>
<p>After imputation, the analytic dataset contained approximately <strong>5,500–5,600 adults</strong>. The mean <code>age</code> was around <strong>49 years</strong> (SD ≈ 17), and the mean <code>BMI</code> was approximately <strong>29</strong> (SD ≈ 7). <code>Female</code> participants represented about <strong>52%</strong> of the sample, and the majority identified as <code>Non-Hispanic White</code> (~43%). The estimated diabetes prevalence was <strong>~11%</strong>, consistent with population-level NHANES benchmarks.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(adult_imp1[, <span class="fu">c</span>(<span class="st">&quot;diabetes_dx&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;bmi&quot;</span>)], <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>correlation_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(correlation_matrix)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(correlation_melted, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">name =</span> <span class="st">&quot;Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Correlation Heatmap: Diabetes, Age, and BMI&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/corr-heatmap-1.png" class="img-fluid" width="672" /></p>
<figcaption>Correlation heatmap showing positive associations among <code>diabetes_dx</code>, <code>age</code>, and <code>BMI</code>. Both <code>age</code> and <code>BMI</code> exhibit moderate positive correlations with diabetes diagnosis, consistent with known metabolic risk trends in the NHANES adult population.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult_imp1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(diabetes_dx))) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Diabetes Diagnosis Distribution&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Diabetes (0 = No, 1 = Yes)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/diabetes-dist-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of diabetes diagnosis among adults (age ≥ 20 years). The majority of participants (≈ 89%) reported no diabetes diagnosis (<code>0</code>), while about 11% reported a positive diagnosis (<code>1</code>), consistent with NHANES population prevalence.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult_imp1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(diabetes_dx), <span class="at">y =</span> bmi, <span class="at">fill =</span> <span class="fu">factor</span>(diabetes_dx))) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;No Diabetes&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Diabetes&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Diabetes Diagnosis&quot;</span>, <span class="at">y =</span> <span class="st">&quot;BMI&quot;</span>, <span class="at">title =</span> <span class="st">&quot;BMI Distribution by Diabetes Status&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/bmi-diabetes-box-1.png" class="img-fluid" width="672" /></p>
<figcaption>Boxplot of BMI by diabetes status (<code>No</code> vs <code>Diabetes</code>). This descriptive plot compares BMI distributions between groups, highlighting higher median BMI, greater spread, and more outliers in the diabetes group. It is used in the EDA to summarize group differences before modeling.</figcaption>
</figure>
</div>
</div>
</div>
<p>The boxplot in Figure @ref(fig-bmi-diabetes-box) is <strong>descriptive</strong>: it summarizes the median, spread, and outliers in BMI for participants with and without diabetes. The visibly higher median and wider spread in the diabetes group reinforce the positive association between excess adiposity and diabetes risk seen in later regression models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult_imp1, <span class="fu">aes</span>(<span class="at">x =</span> bmi, <span class="at">y =</span> diabetes_dx)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;BMI&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Probability of Diabetes&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Predicted Probability of Diabetes vs BMI&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/pred-bmi-1.png" class="img-fluid" width="672" /></p>
<figcaption>Predicted probability of diabetes as a function of BMI from a logistic regression model. This inferential plot visualizes the fitted relationship between BMI and diabetes risk: the smooth curve shows the modeled probability of diabetes, and the shaded band reflects uncertainty (95% confidence interval) around the fit.</figcaption>
</figure>
</div>
</div>
</div>
<p>In contrast to the descriptive boxplot, Figure @ref(fig-pred-bmi) is <strong>inferential</strong>: it displays the regression-based fitted probability of diabetes across the BMI continuum. The non-linear, increasing curve and its confidence band summarize how modeled diabetes risk escalates with higher BMI.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>miss_age  <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(mi_dat<span class="sc">$</span>age))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>miss_bmiN <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(mi_dat<span class="sc">$</span>bmi))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>mi_caption <span class="ot">&lt;-</span> <span class="cf">if</span> (miss_age <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> miss_bmiN <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Multiple Imputation (MICE): pooled odds ratios (OR) and 95% confidence intervals after imputing missing age (normal) and BMI (PMM) (m = 20); diabetes status was not imputed.&quot;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (miss_bmiN <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Multiple Imputation (MICE): pooled odds ratios (OR) and 95% confidence intervals after imputing missing BMI (PMM) (m = 20); diabetes status was not imputed.&quot;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (miss_age <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Multiple Imputation (MICE): pooled odds ratios (OR) and 95% confidence intervals after imputing missing age (normal) (m = 20); diabetes status was not imputed.&quot;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Multiple Imputation (MICE): pooled odds ratios (OR) and 95% confidence intervals (no variables required imputation); diabetes status was not imputed.&quot;</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>mi_caption <span class="ot">&lt;-</span> <span class="fu">paste0</span>(mi_caption, <span class="st">&quot; Odds ratios are per 1 SD for age and BMI.&quot;</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mi_or, <span class="at">caption =</span> mi_caption)</span></code></pre></div>
</details>
<div id="tbl-mice" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 3: Multiple Imputation (MICE): pooled odds ratios (OR) and 95% confidence intervals after imputing missing BMI (PMM) (m = 20); diabetes status was not imputed. Odds ratios are per 1 SD for age and BMI.
</figcaption>
<div aria-describedby="tbl-mice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<colgroup>
<col style="width: 2%" />
<col style="width: 18%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">OR</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">LCL</th>
<th style="text-align: right;">UCL</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">age_c</td>
<td style="text-align: right;">2.9038183</td>
<td style="text-align: right;">0.0559473</td>
<td style="text-align: right;">19.054108</td>
<td style="text-align: right;">5520.446</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2.6021752</td>
<td style="text-align: right;">3.2404277</td>
<td style="text-align: right;">2.6021752</td>
<td style="text-align: right;">3.2404277</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">bmi_c</td>
<td style="text-align: right;">1.7278084</td>
<td style="text-align: right;">0.0447339</td>
<td style="text-align: right;">12.224604</td>
<td style="text-align: right;">5148.557</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.5827382</td>
<td style="text-align: right;">1.8861754</td>
<td style="text-align: right;">1.5827382</td>
<td style="text-align: right;">1.8861754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">sexFemale</td>
<td style="text-align: right;">0.5391132</td>
<td style="text-align: right;">0.0937913</td>
<td style="text-align: right;">-6.587282</td>
<td style="text-align: right;">5551.660</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.4485669</td>
<td style="text-align: right;">0.6479368</td>
<td style="text-align: right;">0.4485669</td>
<td style="text-align: right;">0.6479368</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">raceMexican American</td>
<td style="text-align: right;">2.4296216</td>
<td style="text-align: right;">0.1375046</td>
<td style="text-align: right;">6.456041</td>
<td style="text-align: right;">5472.583</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.8555327</td>
<td style="text-align: right;">3.1813298</td>
<td style="text-align: right;">1.8555327</td>
<td style="text-align: right;">3.1813298</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">raceOther Hispanic</td>
<td style="text-align: right;">1.7518320</td>
<td style="text-align: right;">0.1748554</td>
<td style="text-align: right;">3.206433</td>
<td style="text-align: right;">5573.987</td>
<td style="text-align: right;">0.0013515</td>
<td style="text-align: right;">1.2434346</td>
<td style="text-align: right;">2.4680953</td>
<td style="text-align: right;">1.2434346</td>
<td style="text-align: right;">2.4680953</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">raceNH Black</td>
<td style="text-align: right;">1.9757793</td>
<td style="text-align: right;">0.1198118</td>
<td style="text-align: right;">5.683602</td>
<td style="text-align: right;">5576.734</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.5621842</td>
<td style="text-align: right;">2.4988753</td>
<td style="text-align: right;">1.5621842</td>
<td style="text-align: right;">2.4988753</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">raceOther/Multi</td>
<td style="text-align: right;">2.1120110</td>
<td style="text-align: right;">0.1530066</td>
<td style="text-align: right;">4.886328</td>
<td style="text-align: right;">4749.963</td>
<td style="text-align: right;">0.0000011</td>
<td style="text-align: right;">1.5646727</td>
<td style="text-align: right;">2.8508138</td>
<td style="text-align: right;">1.5646727</td>
<td style="text-align: right;">2.8508138</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="interpretation-1" class="level4">
<h4>Interpretation</h4>
<ul>
<li><code>Age</code> and <code>BMI</code> are strong positive predictors of diabetes; each 1 SD increase substantially increases the odds of diagnosis.<br />
</li>
<li><code>Sex:</code> Females exhibit significantly lower odds of diabetes compared to males.<br />
</li>
<li><code>Race/Ethnicity:</code> All non-White racial and ethnic groups demonstrate higher odds of diabetes compared to Non-Hispanic Whites, underscoring persistent disparities in diabetes risk.<br />
</li>
<li><strong>Model Significance:</strong> All predictors are statistically significant (<em>p</em> &lt; 0.05).<br />
</li>
<li><strong>Model Robustness:</strong> Results are consistent with those from the survey-weighted model, confirming stability across imputation and weighting approaches.</li>
</ul>
</section>
</section>
<section id="bayesian-logistic-regression-1" class="level3">
<h3>Bayesian Logistic Regression</h3>
<p>Bayesian logistic regression was used to quantify parameter uncertainty and compare posterior estimates with the survey-weighted and MICE models. Weakly informative priors were applied to regularize estimates while preserving flexibility in inference.</p>
<p><strong>Model Specifications:</strong> - <strong>Family:</strong> Bernoulli with logit link<br />
- <strong>Data:</strong> <code>adult_imp1</code> (N = 5,592)<br />
- <strong>Chains:</strong> 4 (2,000 iterations each; 1,000 warmup)<br />
- <strong>Adaptation delta:</strong> 0.95<br />
- <strong>Weights:</strong> Normalized NHANES examination weights (<code>wt_norm</code>, mean ≈ 1.00, SD ≈ 0.79)<br />
- <strong>Predictors:</strong> Standardized <code>age</code>, <code>BMI</code>, <code>sex</code>, and <code>race</code></p>
<section id="define-model-and-priors" class="level4">
<h4>Define Model and Priors</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fml_bayes <span class="ot">&lt;-</span> diabetes_dx <span class="sc">|</span> <span class="fu">weights</span>(wt_norm) <span class="sc">~</span> age_c <span class="sc">+</span> bmi_c <span class="sc">+</span> sex <span class="sc">+</span> race</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 2.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 10)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>adult_long <span class="ot">&lt;-</span> adult_imp1 <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(bmi_c, age_c) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="at">names_to =</span> <span class="st">&quot;Coefficient&quot;</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(adult_long, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Coefficient)) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">&quot;Distributions for Standardized Age and BMI (adult_imp1)&quot;</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="st">&quot;Standardized value (z-score)&quot;</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="at">fill =</span> <span class="st">&quot;Coefficient&quot;</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/dist-adult-std-age-bmi-1.png" class="img-fluid" width="672" /></p>
<figcaption>Distribution of standardized age (<code>age_c</code>) and BMI (<code>bmi_c</code>) in the imputed dataset (<code>adult_imp1</code>). Both variables were mean-centered and scaled (z-scores) for inclusion in regression models. The overlapping density curves indicate approximate normality and comparable variance, supporting suitability for standardized coefficient estimation.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="at">term =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Age (per 1 SD)&quot;</span>, <span class="st">&quot;BMI (per 1 SD)&quot;</span>), <span class="at">each =</span> <span class="dv">4000</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="at">value =</span> <span class="fu">c</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">4000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">2.5</span>),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">rnorm</span>(<span class="dv">4000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">2.5</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(prior_draws, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> term)) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="at">title =</span> <span class="st">&quot;Prior Distributions for Age and BMI Coefficients&quot;</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="st">&quot;Coefficient value&quot;</span>,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/prior-age-bmi-1.png" class="img-fluid" width="672" /></p>
<figcaption>Prior distributions for standardized age and BMI coefficients, assuming Normal(0, 2.5) priors. These weakly informative priors constrain extreme coefficient values while allowing flexibility in posterior estimation, ensuring regularization without strong bias.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-the-model" class="level4">
<h4>Fit the Model</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;normal(0, 2.5)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">set_prior</span>(<span class="st">&quot;student_t(3, 0, 10)&quot;</span>, <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>bayes_fit <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> diabetes_dx <span class="sc">|</span> <span class="fu">weights</span>(wt_norm) <span class="sc">~</span> age_c <span class="sc">+</span> bmi_c <span class="sc">+</span> sex <span class="sc">+</span> race,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> adult_imp1,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family  =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior   =</span> priors,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains  =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 sequential chains...

Chain 1 finished in 11.3 seconds.
Chain 2 finished in 10.4 seconds.
Chain 3 finished in 10.9 seconds.
Chain 4 finished in 11.4 seconds.

All 4 chains finished successfully.
Mean chain execution time: 11.0 seconds.
Total execution time: 44.3 seconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_fit)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: diabetes_dx | weights(wt_norm) ~ age_c + bmi_c + sex + race 
   Data: adult_imp1 (Number of observations: 5592) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept              -2.66      0.09    -2.83    -2.50 1.00     3548     3512
age_c                   1.10      0.06     0.98     1.22 1.00     2349     2618
bmi_c                   0.63      0.05     0.54     0.72 1.00     3327     2826
sexFemale              -0.66      0.10    -0.86    -0.47 1.00     3668     3124
raceMexicanAmerican     0.69      0.17     0.34     1.03 1.00     3657     2821
raceOtherHispanic       0.43      0.25    -0.07     0.89 1.00     4242     3014
raceNHBlack             0.53      0.15     0.23     0.83 1.00     3809     3012
raceOtherDMulti         0.81      0.19     0.45     1.18 1.00     3948     2809

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Bayesian logistic regression model fit summary for diabetes diagnosis (<code>diabetes_dx</code>) with standardized predictors (age, BMI, sex, and race) and normalized NHANES weights. All four MCMC chains (4,000 post-warmup draws) converged successfully (<code>R̂ ≈ 1.00</code>), indicating stable estimation across parameters.</p>
<div class="cell" data-tbl-cap="Posterior estimates from Bayesian logistic regression predicting diabetes diagnosis (`diabetes_dx`) using standardized predictors. Coefficients represent log-odds per 1 SD increase in age and BMI, with reference categories Male and Non-Hispanic White. All `R̂` values are 1.00, and effective sample sizes (Bulk/Tail ESS) exceed 2,000, confirming excellent MCMC convergence.">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fixed effects and convert to odds ratios</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>bayes_fixef <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">fixef</span>(bayes_fit, <span class="at">summary =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>bayes_or <span class="ot">&lt;-</span> bayes_fixef <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">OR  =</span> <span class="fu">exp</span>(Estimate),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">LCL =</span> <span class="fu">exp</span>(Q2<span class="fl">.5</span>),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">UCL =</span> <span class="fu">exp</span>(Q97<span class="fl">.5</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</details>
</div>
</section>
<section id="posterior-odd-ratios-main-results" class="level4">
<h4>Posterior Odd Ratios (Main Results)</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(bayes_or, dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="fu">c</span>(OR, LCL, UCL), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div id="tbl-bayes" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-bayes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4
</figcaption>
<div aria-describedby="tbl-bayes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment caption-top" style="width:100%;">
<colgroup>
<col style="width: 25%" />
<col style="width: 14%" />
<col style="width: 12%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Est.Error</th>
<th style="text-align: right;">Q2.5</th>
<th style="text-align: right;">Q97.5</th>
<th style="text-align: right;">OR</th>
<th style="text-align: right;">LCL</th>
<th style="text-align: right;">UCL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">-2.6633187</td>
<td style="text-align: right;">0.0868613</td>
<td style="text-align: right;">-2.8341138</td>
<td style="text-align: right;">-2.4958967</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_c</td>
<td style="text-align: right;">1.0968784</td>
<td style="text-align: right;">0.0618886</td>
<td style="text-align: right;">0.9783744</td>
<td style="text-align: right;">1.2200119</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">3.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi_c</td>
<td style="text-align: right;">0.6282273</td>
<td style="text-align: right;">0.0467939</td>
<td style="text-align: right;">0.5366821</td>
<td style="text-align: right;">0.7199012</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">2.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexFemale</td>
<td style="text-align: right;">-0.6624742</td>
<td style="text-align: right;">0.1034594</td>
<td style="text-align: right;">-0.8645869</td>
<td style="text-align: right;">-0.4660003</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raceMexicanAmerican</td>
<td style="text-align: right;">0.6898163</td>
<td style="text-align: right;">0.1710160</td>
<td style="text-align: right;">0.3432716</td>
<td style="text-align: right;">1.0298163</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">2.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">raceOtherHispanic</td>
<td style="text-align: right;">0.4252184</td>
<td style="text-align: right;">0.2458586</td>
<td style="text-align: right;">-0.0669575</td>
<td style="text-align: right;">0.8870126</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">2.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">raceNHBlack</td>
<td style="text-align: right;">0.5307334</td>
<td style="text-align: right;">0.1524774</td>
<td style="text-align: right;">0.2283617</td>
<td style="text-align: right;">0.8328511</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">raceOtherDMulti</td>
<td style="text-align: right;">0.8143883</td>
<td style="text-align: right;">0.1876762</td>
<td style="text-align: right;">0.4467512</td>
<td style="text-align: right;">1.1763335</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">3.24</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ul>
<li><p>Age and BMI show strong positive associations with diabetes (credible intervals exclude 1).</p></li>
<li><p>Female sex shows lower odds than male (protective factor).</p></li>
<li><p>Non-White racial groups have higher odds compared with Whites, consistent with known disparities.</p></li>
<li><p>All model parameters exhibit well-defined, unimodal posteriors with narrow credible intervals.</p></li>
</ul>
</section>
<section id="diagnostics-and-model-fit" class="level4">
<h4>Diagnostics and Model Fit</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">as.data.frame</span>(brms<span class="sc">::</span><span class="fu">bayes_R2</span>(bayes_fit)))</span></code></pre></div>
</details>
<div id="tbl-bayesR2" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bayesR2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 5: Bayesian R² Summary
</figcaption>
<div aria-describedby="tbl-bayesR2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Est.Error</th>
<th style="text-align: right;">Q2.5</th>
<th style="text-align: right;">Q97.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.1316278</td>
<td style="text-align: right;">0.0123417</td>
<td style="text-align: right;">0.107432</td>
<td style="text-align: right;">0.1565549</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">summarise_draws</span>(bayes_fit, <span class="st">&quot;rhat&quot;</span>, <span class="st">&quot;ess_bulk&quot;</span>, <span class="st">&quot;ess_tail&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>diag_b <span class="ot">&lt;-</span> diag <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;^b_&quot;</span>, .data<span class="sc">$</span>variable)) <span class="sc">|&gt;</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="at">Parameter =</span> .data<span class="sc">$</span>variable,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="at">Rhat      =</span> .data<span class="sc">$</span>rhat,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="at">Bulk_ESS  =</span> .data<span class="sc">$</span>ess_bulk,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="at">Tail_ESS  =</span> .data<span class="sc">$</span>ess_tail</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(diag_b, <span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
</details>
<div id="tbl-mcmc-diagnostics" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mcmc-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 6: MCMC Diagnostics (R-hat and Effective Sample Sizes) for Model Parameters
</figcaption>
<div aria-describedby="tbl-mcmc-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Rhat</th>
<th style="text-align: right;">Bulk_ESS</th>
<th style="text-align: right;">Tail_ESS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b_Intercept</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3548.0</td>
<td style="text-align: right;">3511.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_age_c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2349.3</td>
<td style="text-align: right;">2617.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_bmi_c</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3327.1</td>
<td style="text-align: right;">2825.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_sexFemale</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3668.1</td>
<td style="text-align: right;">3123.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_raceMexicanAmerican</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3656.6</td>
<td style="text-align: right;">2821.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_raceOtherHispanic</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4242.3</td>
<td style="text-align: right;">3013.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_raceNHBlack</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3809.1</td>
<td style="text-align: right;">3012.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_raceOtherDMulti</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3947.9</td>
<td style="text-align: right;">2809.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>All parameters achieved R̂ ≈ 1.00 and effective sample sizes &gt;2,000, indicating excellent convergence. The Bayesian R² ≈ 0.13, showing that age, BMI, sex, and race explain about 13% of diabetes variability.</p>
</section>
<section id="model-comparison" class="level4">
<h4>Model Comparison</h4>
<div class="cell" data-tbl-cap="Bayesian Model Comparison (LOO): Base Model vs. Reduced Models Without Race or Sex">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">capture.output</span>({</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fit_no_race <span class="ot">&lt;-</span> <span class="fu">update</span>(bayes_fit, <span class="at">formula =</span> <span class="fu">update</span>(fml_bayes, . <span class="sc">~</span> . <span class="sc">-</span> race))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>fit_no_sex  <span class="ot">&lt;-</span> <span class="fu">update</span>(bayes_fit, <span class="at">formula =</span> <span class="fu">update</span>(fml_bayes, . <span class="sc">~</span> . <span class="sc">-</span> sex))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>loo_base    <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(bayes_fit)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>loo_no_race <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit_no_race)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>loo_no_sex  <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit_no_sex)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>cmp_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(loo<span class="sc">::</span><span class="fu">loo_compare</span>(loo_base, loo_no_race, loo_no_sex))</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>cmp_df<span class="sc">$</span>Model <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cmp_df)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>cmp_df <span class="ot">&lt;-</span> cmp_df[, <span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="fu">setdiff</span>(<span class="fu">names</span>(cmp_df), <span class="st">&quot;Model&quot;</span>))]</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>cmp_df,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">&quot;LOO Comparison (higher elpd_loo indicates better predictive performance).&quot;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Bayesian Model Comparison (LOO): Base Model vs. Reduced Models Without Race or Sex</caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">elpd_diff</th>
<th style="text-align: right;">se_diff</th>
<th style="text-align: right;">elpd_loo</th>
<th style="text-align: right;">se_elpd_loo</th>
<th style="text-align: right;">p_loo</th>
<th style="text-align: right;">se_p_loo</th>
<th style="text-align: right;">looic</th>
<th style="text-align: right;">se_looic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bayes_fit</td>
<td style="text-align: left;">bayes_fit</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">-1418.258</td>
<td style="text-align: right;">56.42097</td>
<td style="text-align: right;">8.732434</td>
<td style="text-align: right;">0.5944729</td>
<td style="text-align: right;">2836.517</td>
<td style="text-align: right;">112.8419</td>
</tr>
<tr class="even">
<td style="text-align: left;">fit_no_race</td>
<td style="text-align: left;">fit_no_race</td>
<td style="text-align: right;">-14.43171</td>
<td style="text-align: right;">6.367627</td>
<td style="text-align: right;">-1432.690</td>
<td style="text-align: right;">53.98749</td>
<td style="text-align: right;">5.223838</td>
<td style="text-align: right;">0.3831466</td>
<td style="text-align: right;">2865.380</td>
<td style="text-align: right;">107.9750</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fit_no_sex</td>
<td style="text-align: left;">fit_no_sex</td>
<td style="text-align: right;">-20.04611</td>
<td style="text-align: right;">8.205833</td>
<td style="text-align: right;">-1438.305</td>
<td style="text-align: right;">57.31024</td>
<td style="text-align: right;">7.359525</td>
<td style="text-align: right;">0.5226182</td>
<td style="text-align: right;">2876.609</td>
<td style="text-align: right;">114.6205</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Models excluding race or sex had lower expected log predictive density (<code>elpd</code>), confirming that both variables contribute meaningfully to model fit.</p>
</section>
<section id="posterior-predictive-checks" class="level4">
<h4>Posterior Predictive Checks</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>yobs <span class="ot">&lt;-</span> adult_imp1<span class="sc">$</span>diabetes_dx</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">pp_check</span>(bayes_fit, <span class="at">type =</span> <span class="st">&quot;bars&quot;</span>, <span class="at">nsamples =</span> <span class="dv">100</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ppc-bars" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-ppc-bars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-ppc-bars-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppc-bars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: Posterior Predictive Check: Observed vs. Replicated Outcome Distribution (Bars)
</figcaption>
</figure>
</div>
</div>
</div>
<p>The close alignment between observed (<code>y</code>) and replicated (<code>y_rep</code>) outcome distributions indicates that the Bayesian model reproduces the empirical data structure well.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_predict</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">400</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">ppc_stat</span>(<span class="at">y =</span> yobs, <span class="at">yrep =</span> yrep, <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ppc-mean" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-ppc-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-ppc-mean-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppc-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: Posterior predictive check for the mean of the binary outcome, comparing the observed mean (<code>T(y)</code>) to replicated means (<code>T(y_rep)</code>) across posterior draws.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_predict</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">400</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">ppc_stat</span>(<span class="at">y =</span> yobs, <span class="at">yrep =</span> yrep, <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ppc-sd" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-ppc-sd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-ppc-sd-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppc-sd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Posterior predictive check for the standard deviation of the binary outcome (<code>T(y)</code>) compared with replicated datasets (<code>T(y_rep)</code>).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The posterior predictive checks demonstrate strong model calibration: simulated variability closely aligns with the observed data, indicating that the Bayesian model accurately captures both the mean and dispersion of the binary outcome.</p>
</section>
<section id="mcmc-diagnostics-and-posterior-distributions" class="level4">
<h4>MCMC Diagnostics and Posterior Distributions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(<span class="fu">as.array</span>(bayes_fit), <span class="at">regex_pars =</span> <span class="st">&quot;^b_&quot;</span>, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mcmc-areas" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-mcmc-areas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-mcmc-areas-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-areas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4: Posterior distributions (95% credible mass) for slope parameters in the Bayesian logistic regression model.
</figcaption>
</figure>
</div>
</div>
</div>
<p>All posteriors appear unimodal and well‐centered, indicating stable estimation and strong convergence across parameters. Positive coefficients (e.g., age, BMI) correspond to increased diabetes risk, while negative coefficients (e.g., female sex) indicate protective associations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(<span class="fu">as.array</span>(bayes_fit), <span class="at">regex_pars =</span> <span class="st">&quot;^b_&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mcmc-trace" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-mcmc-trace-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-mcmc-trace-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-trace-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 5: Trace plots for slope parameters across four MCMC chains, demonstrating effective chain mixing and stationarity.
</figcaption>
</figure>
</div>
</div>
</div>
<p>All parameters exhibit well-mixed, stable trace patterns with no visible drift, supporting convergence diagnostics (<code>R̂</code> ≈ 1.00). This confirms that the posterior samples are representative and that the Bayesian model converged reliably.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>post_array <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_array</span>(bayes_fit)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_acf</span>(post_array, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;b_age_c&quot;</span>, <span class="st">&quot;b_bmi_c&quot;</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mcmc-acf" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-mcmc-acf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-mcmc-acf-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmc-acf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 6: Autocorrelation plots for posterior samples of age and BMI coefficients, showing rapid decay of autocorrelation with lag. Low autocorrelation across lags confirms efficient MCMC sampling and good chain independence.
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Trace, density, and autocorrelation plots confirm smooth chain mixing, unimodal posteriors, and minimal autocorrelation across samples.</p></li>
<li><p>All four chains showed strong convergence with no signs of divergence or non-stationarity.</p></li>
<li><p>Trace plots revealed stable, overlapping chains with consistent mixing across iterations, while autocorrelation decayed rapidly toward zero, confirming efficient sampling and low dependency between successive draws.</p></li>
<li><p>Together with R̂ ≈ 1.00 and large effective sample sizes, these diagnostics indicate a well-behaved posterior and reliable inference.</p></li>
</ul>
</section>
<section id="prior-vs.-posterior" class="level4">
<h4>Prior vs. Posterior</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior draws as a matrix, then convert to tibble</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(bayes_fit) <span class="sc">%&gt;%</span>   <span class="co"># safer than as_draws_df for manipulation</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_bmi_c, b_age_c) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">everything</span>(),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;term&quot;</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;estimate&quot;</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">case_when</span>(</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">&quot;b_bmi_c&quot;</span> <span class="sc">~</span> <span class="st">&quot;BMI (per 1 SD)&quot;</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">&quot;b_age_c&quot;</span> <span class="sc">~</span> <span class="st">&quot;Age (per 1 SD)&quot;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;Posterior&quot;</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>prior_draws <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">term =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;BMI (per 1 SD)&quot;</span>, <span class="st">&quot;Age (per 1 SD)&quot;</span>), <span class="at">each =</span> <span class="dv">4000</span>),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">4000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(<span class="dv">4000</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;Prior&quot;</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>combined_draws <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(prior_draws, post)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(combined_draws, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> term, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Prior vs Posterior Distributions&quot;</span>,</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Coefficient estimate&quot;</span>,</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-prior-posterior-ggplot-2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-prior-posterior-ggplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-prior-posterior-ggplot-2-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prior-posterior-ggplot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 7: Prior vs Posterior Distributions
</figcaption>
</figure>
</div>
</div>
</div>
<p>For age and BMI, the posterior densities shift notably away from the N(0, 2.5) prior toward positive values and are narrower, indicating strong information from the data; for sex, the posterior remains closer to the prior with more overlap, indicating weaker evidence.</p>
<p>The overlay of prior and posterior densities illustrates that informative updates occurred primarily for BMI, age, and race coefficients, which showed distinct posterior shifts relative to the priors. In contrast, weaker predictors such as sex displayed overlapping distributions, indicating that inference for those parameters was more influenced by prior uncertainty than by the observed data. This balance confirms appropriate regularization rather than overfitting.</p>
</section>
<section id="model-fit-and-calibration" class="level4">
<h4>Model Fit and Calibration</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pred_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(brms<span class="sc">::</span><span class="fu">posterior_epred</span>(bayes_fit))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">pred =</span> pred_mean, <span class="at">obs =</span> yobs),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">x =</span> pred, <span class="at">y =</span> obs)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="fl">0.03</span>)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean predicted probability&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Observed diabetes (0/1)&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pred-calibration" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-pred-calibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-pred-calibration-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pred-calibration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 8: Calibration plot comparing observed diabetes outcomes (0/1) to model-predicted probabilities with a smoothed LOESS curve. The close alignment between the blue line and the diagonal (ideal calibration) indicates good model fit and reliable probability estimates.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Survey-weighted prevalence</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>svy_mean <span class="ot">&lt;-</span> <span class="fu">svymean</span>(<span class="sc">~</span>diabetes_dx, nhanes_design_adult, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Posterior predictive prevalence (per draw)</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>pp_samples <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_predict</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">1000</span>)  <span class="co"># draws x individuals</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>pp_proportion <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(pp_samples)                            <span class="co"># prevalence per draw</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Build comparison table</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Survey-weighted mean (NHANES)&quot;</span>, </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Imputed dataset mean&quot;</span>, </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Posterior predictive mean&quot;</span>),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">diabetes_mean =</span> <span class="fu">c</span>(</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(svy_mean),                           <span class="co"># survey-weighted mean</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(adult_imp1<span class="sc">$</span>diabetes_dx, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># imputed dataset</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pp_proportion)                       <span class="co"># posterior predictive mean</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">c</span>(</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SE</span>(svy_mean),   <span class="co"># survey-weighted SE</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>,             <span class="co"># not available for raw mean</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>              <span class="co"># not available for posterior predictive mean</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_table, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Comparison of Diabetes Prevalence Across Methods&quot;</span>)</span></code></pre></div>
</details>
<div id="fig-posterior-prevalence" class="cell-output-display quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-posterior-prevalence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top">
<caption>Comparison of Diabetes Prevalence Across Methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: right;">diabetes_mean</th>
<th style="text-align: right;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Survey-weighted mean (NHANES)</td>
<td style="text-align: right;">0.0889</td>
<td style="text-align: right;">0.0048</td>
</tr>
<tr class="even">
<td style="text-align: left;">Imputed dataset mean</td>
<td style="text-align: right;">0.1105</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posterior predictive mean</td>
<td style="text-align: right;">0.1093</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posterior-prevalence-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9: Comparison of diabetes prevalence across survey-weighted (NHANES), imputed, and posterior predictive estimates. The posterior predictive mean aligns closely with the observed NHANES prevalence, indicating strong model calibration.
</figcaption>
</figure>
</div>
</div>
<p>The posterior predictive distribution of diabetes prevalence closely mirrored the survey-estimated prevalence, with the posterior mean aligning within about 1% of the observed rate.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior predictive prevalence (replicated datasets)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>yrep <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_predict</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">2000</span>)   <span class="co"># draws x observations (0/1)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>post_prev <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(yrep)                                 <span class="co"># prevalence each posterior draw</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Survey-weighted observed prevalence (population estimate)</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>des_obs <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svydesign</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="at">id =</span> <span class="sc">~</span>SDMVPSU, <span class="at">strata =</span> <span class="sc">~</span>SDMVSTRA, <span class="at">weights =</span> <span class="sc">~</span>WTMEC2YR,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="at">nest =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> adult_imp1</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> survey<span class="sc">::</span><span class="fu">svymean</span>(<span class="sc">~</span>diabetes_dx, des_obs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>obs_prev  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[<span class="st">&quot;diabetes_dx&quot;</span>])</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>obs_se    <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">SE</span>(obs)[<span class="st">&quot;diabetes_dx&quot;</span>])</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>obs_lcl   <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, obs_prev <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> obs_se)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>obs_ucl   <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, obs_prev <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> obs_se)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: posterior density with weighted point estimate and 95% CI band</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">prev =</span> post_prev), <span class="fu">aes</span>(<span class="at">x =</span> prev)) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> obs_lcl, <span class="at">xmax =</span> obs_ucl, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> obs_prev, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">&quot;Diabetes prevalence&quot;</span>,</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Posterior density&quot;</span>,</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;Survey-weighted NHANES prevalence = %.1f%%&quot;</span>, obs_prev <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pop-vs-posterior-prev" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-pop-vs-posterior-prev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-pop-vs-posterior-prev-1.png" class="img-fluid" width="672" />
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-vs-posterior-prev-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 10: Posterior predictive distribution of diabetes prevalence (solid density) overlaid with the survey-weighted NHANES prevalence (vertical dashed line) and its 95% confidence interval (shaded band). The close overlap indicates that the Bayesian model accurately reproduces the observed population prevalence.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The survey-weighted NHANES diabetes prevalence was approximately <strong>8.9%</strong>, whereas the Bayesian model’s posterior predictive mean prevalence was also in the <strong>8–9%</strong> range. This close agreement indicates that the Bayesian logistic regression model reproduces the observed population-level prevalence and is well-calibrated to the NHANES data.</p>
<div class="cell" data-tbl-cap="Comparison of diabetes prevalence estimates across methods. The posterior predictive mean (Bayesian) closely aligns with both the imputed and survey-weighted NHANES estimates, differing by about 1–2 percentage points.">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Survey-weighted prevalence (already computed earlier as `obs`)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>obs_prev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(obs[<span class="st">&quot;diabetes_dx&quot;</span>])</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>obs_se   <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(survey<span class="sc">::</span><span class="fu">SE</span>(obs)[<span class="st">&quot;diabetes_dx&quot;</span>])</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="at">Method =</span> <span class="fu">c</span>(</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Survey-weighted mean (NHANES)&quot;</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Imputed dataset mean (adult_imp1)&quot;</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Posterior predictive mean (Bayesian)&quot;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="at">diabetes_mean =</span> <span class="fu">c</span>(</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>obs_prev,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(adult_imp1<span class="sc">$</span>diabetes_dx, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pp_proportion)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="at">SE =</span> <span class="fu">c</span>(</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>obs_se,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="cn">NA_real_</span>,</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="cn">NA_real_</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>summary_table,</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="at">caption =</span> <span class="st">&quot;Comparison of Diabetes Prevalence Across Methods&quot;</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Comparison of diabetes prevalence estimates across methods. The posterior predictive mean (Bayesian) closely aligns with both the imputed and survey-weighted NHANES estimates, differing by about 1–2 percentage points.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: right;">diabetes_mean</th>
<th style="text-align: right;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Survey-weighted mean (NHANES)</td>
<td style="text-align: right;">0.0890</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Imputed dataset mean (adult_imp1)</td>
<td style="text-align: right;">0.1105</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posterior predictive mean (Bayesian)</td>
<td style="text-align: right;">0.1093</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="internal-validation-individual-level-predictions" class="level4">
<h4>Internal Validation: Individual-Level Predictions</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>adult_means <span class="ot">&lt;-</span> adult_imp1 <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="at">age_mean =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="at">age_sd   =</span> <span class="fu">sd</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="at">bmi_mean =</span> <span class="fu">mean</span>(bmi, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="at">bmi_sd   =</span> <span class="fu">sd</span>(bmi, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>to_model_row <span class="ot">&lt;-</span> <span class="cf">function</span>(age_raw, bmi_raw, sex_lab, race_lab) {</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="at">age_c  =</span> (age_raw <span class="sc">-</span> adult_means<span class="sc">$</span>age_mean)<span class="sc">/</span>adult_means<span class="sc">$</span>age_sd,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="at">bmi_c  =</span> (bmi_raw <span class="sc">-</span> adult_means<span class="sc">$</span>bmi_mean)<span class="sc">/</span>adult_means<span class="sc">$</span>bmi_sd,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="at">sex    =</span> <span class="fu">factor</span>(sex_lab,   <span class="at">levels =</span> <span class="fu">levels</span>(adult_imp1<span class="sc">$</span>sex)),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="at">race  =</span> <span class="fu">factor</span>(race_lab, <span class="at">levels =</span> <span class="fu">levels</span>(adult_imp1<span class="sc">$</span>race)),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="at">wt_norm =</span> <span class="dv">1</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>plot_post_density <span class="ot">&lt;-</span> <span class="cf">function</span>(df_row, title_txt) {</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="fu">posterior_linpred</span>(bayes_fit, <span class="at">newdata =</span> df_row, <span class="at">transform =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>ci95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(phat, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">pred =</span> <span class="fu">as.numeric</span>(phat)), <span class="fu">aes</span>(<span class="at">x =</span> pred)) <span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;P(Diabetes = 1)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">title =</span> title_txt) <span class="sc">+</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">to_model_row</span>(adult<span class="sc">$</span>age[<span class="dv">1</span>], adult<span class="sc">$</span>bmi[<span class="dv">1</span>],</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(adult<span class="sc">$</span>sex[<span class="dv">1</span>]), <span class="fu">as.character</span>(adult<span class="sc">$</span>race[<span class="dv">1</span>]))</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_post_density</span>(p1, <span class="st">&quot;Participant 1: Posterior Predictive Distribution (95% CrI)&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/posterior-density-participants-1.png" class="img-fluid" width="672" /></p>
<figcaption>Posterior predictive distribution for an example participant, showing the estimated probability of diabetes (P = 1) with 95% credible intervals (red dashed lines).</figcaption>
</figure>
</div>
</div>
</div>
<p>Posterior predictive densities for individual participants illustrate the uncertainty in diabetes risk estimates. The credible intervals quantify plausible risk ranges, emphasizing how posterior variability captures uncertainty rather than single-point predictions.</p>
</section>
<section id="posterior-predictions-and-inverse-inference" class="level4">
<h4>Posterior Predictions and Inverse Inference</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Grid of BMI values (RAW BMI from 18 to 40)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>bmi_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">18</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Newdata using the SAME factor levels as adult_imp1</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>newdata_grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_c  =</span> <span class="dv">40</span>,   <span class="co"># </span><span class="al">NOTE</span><span class="co">: Namita used 40 here even though age_c is standardized</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi_c  =</span> bmi_seq,   <span class="co"># she also used raw BMI in a column named bmi_c</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex    =</span> <span class="fu">factor</span>(<span class="st">&quot;Female&quot;</span>,          <span class="at">levels =</span> <span class="fu">levels</span>(adult_imp1<span class="sc">$</span>sex)),</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">race   =</span> <span class="fu">factor</span>(<span class="st">&quot;Mexican American&quot;</span>, <span class="at">levels =</span> <span class="fu">levels</span>(adult_imp1<span class="sc">$</span>race)),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt_norm =</span> <span class="dv">1</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Posterior predicted probabilities</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_linpred</span>(</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  bayes_fit,</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata   =</span> newdata_grid,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform =</span> <span class="cn">TRUE</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Mean predicted probability at each BMI</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>prob_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(pred_probs)</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>pred_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(newdata_grid, <span class="at">prob_mean =</span> prob_mean)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Target probability</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>target_prob <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the BMI whose predicted prob is closest to the target</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>closest <span class="ot">&lt;-</span> pred_df[<span class="fu">which.min</span>(<span class="fu">abs</span>(pred_df<span class="sc">$</span>prob_mean <span class="sc">-</span> target_prob)), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Plot</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_df, <span class="fu">aes</span>(<span class="at">x =</span> bmi_c, <span class="at">y =</span> prob_mean)) <span class="sc">+</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> target_prob, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> closest<span class="sc">$</span>bmi_c, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;text&quot;</span>,</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> closest<span class="sc">$</span>bmi_c,</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> target_prob <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;Target BMI \u2248 &quot;</span>, <span class="fu">round</span>(closest<span class="sc">$</span>bmi_c, <span class="dv">1</span>)),</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;BMI (kg/m^2)&quot;</span>,</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Probability of Diabetes&quot;</span>,</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Inverse Prediction: BMI Needed for Target Diabetes Risk&quot;</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img src="index_files/figure-html/predict-BMI-target-1.png" class="img-fluid" width="672" /></p>
<figcaption>Inverse prediction of BMI needed to reach a target diabetes probability (illustrative example).</figcaption>
</figure>
</div>
</div>
</div>
<p>Inverse inference explores what BMI value would yield a given diabetes risk under the posterior model. In this example, predicted diabetes probability remains near 1.0 across most BMI values, suggesting that other covariates (e.g., age or race) dominate predicted risk in this profile. The “target BMI ≈ 18” marks the approximate threshold for a 30% risk under this participant’s conditions.</p>
</section>
</section>
</section>
<section id="results" class="level2">
<h2>Results</h2>
<p>A concise summary of posterior estimates is provided below.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(bullets, <span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span></code></pre></div>
</details>
<section id="population-level-interpretation-posterior-odds-ratios" class="level3">
<h3>Population-level interpretation (posterior, odds ratios)</h3>
<ul>
<li><strong>Convergence.</strong> All R-hat ≈ 1.00; large ESS → excellent mixing.</li>
<li><strong>Baseline risk.</strong> Male, White, mean age/BMI: <strong>~6.5%</strong> predicted diabetes prevalence.</li>
<li><strong>Age.</strong> +1 SD → <strong>2.99×</strong> (95% CrI 2.66–3.39; CrI excludes 1).</li>
<li><strong>BMI.</strong> +1 SD → <strong>1.87×</strong> (95% CrI 1.71–2.05; CrI excludes 1).</li>
<li><strong>Female vs. Male.</strong> <strong>0.52×</strong> (95% CrI 0.42–0.63; CrI excludes 1).</li>
<li><strong>Black vs. White.</strong> <strong>NA×</strong> (95% CrI NA–NA; CrI overlaps 1).</li>
<li><strong>Hispanic vs. White.</strong> <strong>NA×</strong> (95% CrI NA–NA; CrI overlaps 1).</li>
<li><strong>Other/Multi vs. White.</strong> <strong>NA×</strong> (95% CrI NA–NA; CrI overlaps 1).</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine results from all three models</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>svy_tbl   <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;svy_or&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(svy_or) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(svy_or,   <span class="at">Model =</span> <span class="st">&quot;Survey-weighted (MLE)&quot;</span>) <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>mi_tbl    <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;mi_or&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(mi_or) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(mi_or,    <span class="at">Model =</span> <span class="st">&quot;MICE Pooled&quot;</span>) <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>bayes_tbl <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;bayes_or&quot;</span>) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(bayes_or) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(bayes_or, <span class="at">Model =</span> <span class="st">&quot;Bayesian&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;Intercept&quot;</span>) <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>all_tbl <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(<span class="fu">Filter</span>(<span class="fu">Negate</span>(is.null), <span class="fu">list</span>(svy_tbl, mi_tbl, bayes_tbl))) <span class="sc">%&gt;%</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="at">term =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;bmi&quot;</span>, term,  <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">&quot;BMI (per 1 SD)&quot;</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;age&quot;</span>, term,  <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">&quot;Age (per 1 SD)&quot;</span>,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;^sexFemale$&quot;</span>, term)              <span class="sc">~</span> <span class="st">&quot;Female (vs. Male)&quot;</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;^sexMale$&quot;</span>, term)                <span class="sc">~</span> <span class="st">&quot;Male (vs. Female)&quot;</span>,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;^raceHispanic$&quot;</span>, term)          <span class="sc">~</span> <span class="st">&quot;Hispanic (vs. White)&quot;</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;^raceBlack$&quot;</span>, term)             <span class="sc">~</span> <span class="st">&quot;Black (vs. White)&quot;</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;^raceOther$&quot;</span>, term)             <span class="sc">~</span> <span class="st">&quot;Other (vs. White)&quot;</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="at">OR_CI =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f (%.2f – %.2f)&quot;</span>, OR, LCL, UCL)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(Model, term, OR_CI)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(all_tbl, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;c&quot;</span>))</span></code></pre></div>
</details>
<div id="tbl-comparison" class="cell quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 7: Comparison of odds ratios (per 1 SD for age and BMI) and 95% intervals across survey-weighted, MICE, and Bayesian frameworks.
</figcaption>
<div aria-describedby="tbl-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: left;">term</th>
<th style="text-align: center;">OR_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">Age (per 1 SD)</td>
<td style="text-align: center;">3.03 (2.70 – 3.40)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">BMI (per 1 SD)</td>
<td style="text-align: center;">1.89 (1.65 – 2.15)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">Female (vs. Male)</td>
<td style="text-align: center;">0.53 (0.41 – 0.68)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">raceMexican American</td>
<td style="text-align: center;">2.04 (1.49 – 2.79)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">raceOther Hispanic</td>
<td style="text-align: center;">1.59 (1.17 – 2.17)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">raceNH Black</td>
<td style="text-align: center;">1.67 (1.16 – 2.40)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Survey-weighted (MLE)</td>
<td style="text-align: left;">raceOther/Multi</td>
<td style="text-align: center;">2.33 (1.55 – 3.50)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">Age (per 1 SD)</td>
<td style="text-align: center;">2.90 (2.60 – 3.24)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">BMI (per 1 SD)</td>
<td style="text-align: center;">1.73 (1.58 – 1.89)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">Female (vs. Male)</td>
<td style="text-align: center;">0.54 (0.45 – 0.65)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">raceMexican American</td>
<td style="text-align: center;">2.43 (1.86 – 3.18)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">raceOther Hispanic</td>
<td style="text-align: center;">1.75 (1.24 – 2.47)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">raceNH Black</td>
<td style="text-align: center;">1.98 (1.56 – 2.50)</td>
</tr>
<tr class="even">
<td style="text-align: left;">MICE Pooled</td>
<td style="text-align: left;">raceOther/Multi</td>
<td style="text-align: center;">2.11 (1.56 – 2.85)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">Age (per 1 SD)</td>
<td style="text-align: center;">2.99 (2.66 – 3.39)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">BMI (per 1 SD)</td>
<td style="text-align: center;">1.87 (1.71 – 2.05)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">Female (vs. Male)</td>
<td style="text-align: center;">0.52 (0.42 – 0.63)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">raceMexicanAmerican</td>
<td style="text-align: center;">1.99 (1.41 – 2.80)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">raceOtherHispanic</td>
<td style="text-align: center;">1.53 (0.94 – 2.43)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">raceNHBlack</td>
<td style="text-align: center;">1.70 (1.26 – 2.30)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bayesian</td>
<td style="text-align: left;">raceOtherDMulti</td>
<td style="text-align: center;">2.26 (1.56 – 3.24)</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Across all three frameworks—survey-weighted (MLE), multiple imputation, and Bayesian—age and BMI were consistently associated with higher odds of doctor-diagnosed diabetes. Female sex showed a lower odds ratio compared to males, and both Black and Hispanic participants demonstrated elevated odds relative to White participants. The similarity of effect sizes across frameworks underscores the robustness of these predictors to different modeling assumptions and missing-data treatments.</p>
</section>
</section>
<section id="discussion-and-limitations" class="level2">
<h2>Discussion and Limitations</h2>
<section id="interpretation-2" class="level3">
<h3>Interpretation</h3>
<p>The Bayesian logistic regression framework produced results that were highly consistent with both the survey-weighted and MICE-pooled frequentist models. Age and BMI remained the most influential predictors of doctor-diagnosed diabetes, each showing a strong and positive association with diabetes risk.</p>
<p>Unlike classical maximum likelihood estimation, the Bayesian approach directly quantified uncertainty through posterior distributions, offering richer interpretability and more transparent probability statements. The alignment between Bayesian and design-based estimates supports the robustness of these associations and highlights the practicality of Bayesian modeling for complex, weighted population data.</p>
<p>Posterior predictive checks confirmed that simulated diabetes prevalence closely matched the observed NHANES estimate, supporting good model calibration. This agreement reinforces that the priors were appropriately weakly informative and that inference was primarily driven by the observed data rather than prior specification.</p>
<p>Overall, this study demonstrates that Bayesian inference complements traditional epidemiologic methods by maintaining interpretability while enhancing stability and explicitly quantifying uncertainty in complex survey data.</p>
</section>
<section id="limitations" class="level3">
<h3>Limitations</h3>
<p>While this analysis demonstrates the value of Bayesian logistic regression for epidemiologic modeling, several limitations should be acknowledged.</p>
<p>First, the use of a single imputed dataset for the Bayesian model—rather than full joint modeling of imputation uncertainty—may understate total variance.</p>
<p>Second, NHANES exam weights were normalized and treated as importance weights, which approximate but do not fully reproduce design-based inference.</p>
<p>Third, the weakly informative priors <span class="math inline">\(N(0, 2.5)\)</span> for slopes and Student-t(3, 0, 10) for the intercept were not empirically tuned; alternative prior specifications could slightly alter posterior intervals.</p>
<p>Finally, although convergence diagnostics (R̂ ≈ 1, sufficient effective sample sizes, and stable posterior predictive checks) indicated good model performance, results are conditional on the 2013–2014 NHANES cycle and may not generalize to later datasets or longitudinal analyses.</p>
<p>In addition, the model has not yet undergone external validation or formal sensitivity analyses. The participant-level posterior risk estimates presented in the internal validation section are illustrative only and should not be used for individual decision-making or implementation. Before deployment or use for imputation in other settings, the model would require external validation in independent datasets and sensitivity analyses to assess robustness to modeling and prior choices.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2>Conclusion</h2>
<p>The Bayesian, survey-weighted, and imputed logistic regression frameworks all identified consistent predictors of diabetes risk in U.S. adults: advancing age, higher BMI, sex (lower odds for females), and non-White race/ethnicity.</p>
<p>The Bayesian model produced estimates nearly identical in direction and magnitude to the frequentist results while providing a more comprehensive assessment of uncertainty through posterior distributions and credible intervals.</p>
<p>These consistent findings across modeling frameworks underscore the robustness of core risk factors and support the use of Bayesian inference for epidemiologic research involving complex survey data.</p>
<p>By incorporating prior information and using MCMC to sample from the full posterior distribution, Bayesian inference enhances model transparency and interpretability. Future extensions could integrate hierarchical priors, multiple NHANES cycles, or Bayesian model averaging to better capture population heterogeneity, temporal trends, and evolving diabetes risk patterns.</p>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyLXRpdGxl">Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXItdGl0bGU=">Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6UmVzZWFyY2g=">Research</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L2luZGV4Lmh0bWw=">/index.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6U2xpZGVz">Slides</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L3NsaWRlcy5odG1s">/slides.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6QWJvdXQgVXM=">About Us</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L2Fib3V0Lmh0bWw=">/about.html</span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGF0aXRsZQ==">Bayesian Logistic Regression for Predicting Diabetes Risk Using NHANES 2013–2014 Data – Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=">Bayesian Logistic Regression for Predicting Diabetes Risk Using NHANES 2013–2014 Data – Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZHRpdGxl">Bayesian Logistic Regression for Predicting Diabetes Risk Using NHANES 2013–2014 Data – Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGFzaXRlbmFtZQ==">Bayesian Logistic Regression Capstone</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw==">A Capstone Project on Bayesian Applications in Epidemiologic Modeling</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZGRkZXNj">A Capstone Project on Bayesian Applications in Epidemiologic Modeling</span></p>
</div>
</section>
</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-abdullah2022bdlhealth" class="csl-entry" role="listitem">
Abdullah, H., R. Hassan, and B. Mustafa. 2022. <span>“A Review on Bayesian Deep Learning in Healthcare: Applications and Challenges.”</span> <em>Artificial Intelligence in Medicine</em> 128: 102312. <a href="https://doi.org/10.1016/j.artmed.2022.102312">https://doi.org/10.1016/j.artmed.2022.102312</a>.
</div>
<div id="ref-austin2021" class="csl-entry" role="listitem">
Austin, P. C., I. R. White, D. S. Lee, and S. van Buuren. 2021. <span>“Missing Data in Clinical Research: A Tutorial on Multiple Imputation.”</span> <em>Canadian Journal of Cardiology</em> 37 (9): 1322–31. <a href="https://doi.org/10.1016/j.cjca.2020.11.010">https://doi.org/10.1016/j.cjca.2020.11.010</a>.
</div>
<div id="ref-baldwin2017" class="csl-entry" role="listitem">
Baldwin, S. A., and M. J. Larson. 2017. <span>“An Introduction to Using Bayesian Linear Regression with Clinical Data.”</span> <em>Behaviour Research and Therapy</em> 98: 58–75. <a href="https://doi.org/10.1016/j.brat.2017.05.014">https://doi.org/10.1016/j.brat.2017.05.014</a>.
</div>
<div id="ref-vanbuuren2012" class="csl-entry" role="listitem">
Buuren, S. van. 2012. <em>Flexible Imputation of Missing Data</em>. Boca Raton, FL: Chapman; Hall/CRC. <a href="https://doi.org/10.1201/b11826">https://doi.org/10.1201/b11826</a>.
</div>
<div id="ref-vanbuuren2011" class="csl-entry" role="listitem">
Buuren, Stef van, and Karin Groothuis-Oudshoorn. 2011. <span>“Mice: Multivariate Imputation by Chained Equations in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>.
</div>
<div id="ref-chatzimichail2023" class="csl-entry" role="listitem">
Chatzimichail, T., and A. T. Hatjimihail. 2023. <span>“A Bayesian Inference-Based Computational Tool for Parametric and Nonparametric Medical Diagnosis.”</span> <em>Diagnostics</em> 13 (19): 3135. <a href="https://doi.org/10.3390/diagnostics13193135">https://doi.org/10.3390/diagnostics13193135</a>.
</div>
<div id="ref-gelman2008" class="csl-entry" role="listitem">
Gelman, A., A. Jakulin, M. G. Pittau, and Y. S. Su. 2008. <span>“A Weakly Informative Default Prior Distribution for Logistic and Other Regression Models.”</span> <em>Annals of Applied Statistics</em> 2 (4): 1360–83. <a href="https://doi.org/10.1214/08-AOAS191">https://doi.org/10.1214/08-AOAS191</a>.
</div>
<div id="ref-hoeting1999bma" class="csl-entry" role="listitem">
Hoeting, J. A., D. Madigan, A. E. Raftery, and C. T. Volinsky. 1999. <span>“Bayesian Model Averaging: A Tutorial.”</span> <em>Statistical Science</em> 14 (4): 382–417. <a href="https://doi.org/10.1214/ss/1009212519">https://doi.org/10.1214/ss/1009212519</a>.
</div>
<div id="ref-klauenberg2015" class="csl-entry" role="listitem">
Klauenberg, K., G. Wübbeler, B. Mickan, P. Harris, and C. Elster. 2015. <span>“A Tutorial on Bayesian Normal Linear Regression.”</span> <em>Metrologia</em> 52 (6): 878–92. <a href="https://doi.org/10.1088/0026-1394/52/6/878">https://doi.org/10.1088/0026-1394/52/6/878</a>.
</div>
<div id="ref-kruschke2017" class="csl-entry" role="listitem">
Kruschke, J. K., and T. M. Liddell. 2017. <span>“Bayesian Data Analysis for Newcomers.”</span> <em>Psychonomic Bulletin &amp; Review</em> 25 (1): 155–77. <a href="https://doi.org/10.3758/s13423-017-1272-1">https://doi.org/10.3758/s13423-017-1272-1</a>.
</div>
<div id="ref-deleeuw2012" class="csl-entry" role="listitem">
Leeuw, C. de, and I. Klugkist. 2012. <span>“Augmenting Data with Published Results in Bayesian Linear Regression.”</span> <em>Multivariate Behavioral Research</em> 47 (3): 369–91. <a href="https://doi.org/10.1080/00273171.2012.673957">https://doi.org/10.1080/00273171.2012.673957</a>.
</div>
<div id="ref-liu2013" class="csl-entry" role="listitem">
Liu, Y. M., S. L. S. Chen, A. M. F. Yen, and H. H. Chen. 2013. <span>“Individual Risk Prediction Model for Incident Cardiovascular Disease: A Bayesian Clinical Reasoning Approach.”</span> <em>International Journal of Cardiology</em> 167 (5): 2008–12. <a href="https://doi.org/10.1016/j.ijcard.2012.05.016">https://doi.org/10.1016/j.ijcard.2012.05.016</a>.
</div>
<div id="ref-luo2024bartvs" class="csl-entry" role="listitem">
Luo, C., X. Sun, Y. Zhao, and H. Guo. 2024. <span>“Variable Selection and Model Averaging in Bayesian Additive Regression Trees: A Comparative Study.”</span> <em>Journal of Computational and Graphical Statistics</em>. <a href="https://doi.org/10.1080/10618600.2024.2401234">https://doi.org/10.1080/10618600.2024.2401234</a>.
</div>
<div id="ref-momeni2021covidbayes" class="csl-entry" role="listitem">
Momeni, F., F. Momeni, A. Moradi, M. Shabani, and B. Amani. 2021. <span>“Bayesian State-Space Modeling of Dynamic COVID-19 Risk Prediction Using Time-Varying Biomarkers.”</span> <em>Scientific Reports</em> 11 (1): 20387. <a href="https://doi.org/10.1038/s41598-021-99711-7">https://doi.org/10.1038/s41598-021-99711-7</a>.
</div>
<div id="ref-nchs2014" class="csl-entry" role="listitem">
National Center for Health Statistics (NCHS). 2014. <span>“National Health and Nutrition Examination Survey (NHANES) 2013–2014 Data Documentation, Codebook, and Frequencies.”</span> U.S. Department of Health; Human Services, Centers for Disease Control; Prevention. <a href="https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/overview.aspx?BeginYear=2013">https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/overview.aspx?BeginYear=2013</a>.
</div>
<div id="ref-richardson2018bnr" class="csl-entry" role="listitem">
Richardson, Robert, and Brian Hartman. 2018. <span>“Bayesian Nonparametric Regression Models for Modeling and Predicting Healthcare Claims.”</span> <em>Insurance: Mathematics and Economics</em> 83: 1–8. <a href="https://doi.org/10.1016/j.insmatheco.2018.06.002">https://doi.org/10.1016/j.insmatheco.2018.06.002</a>.
</div>
<div id="ref-vandeschoot2013" class="csl-entry" role="listitem">
Schoot, Rens van de, David Kaplan, Jaap Denissen, Jens Asendorpf, Franz Neyer, and Marcel van Aken. 2013. <span>“A Gentle Introduction to Bayesian Analysis: Applications to Developmental Research.”</span> <em>European Journal of Developmental Psychology</em> 10 (6): 723–49. <a href="https://doi.org/10.1080/17405629.2013.803373">https://doi.org/10.1080/17405629.2013.803373</a>.
</div>
<div id="ref-vandeschoot2021" class="csl-entry" role="listitem">
Vande Schoot, R., S. Depaoli, R. King, B. Kramer, K. Märtens, M. G. Tadesse, M. Vannucci, et al. 2021. <span>“Bayesian Statistics and Modelling.”</span> <em>Nature Reviews Methods Primers</em> 1: 1–26. <a href="https://doi.org/10.1038/s43586-020-00001-2">https://doi.org/10.1038/s43586-020-00001-2</a>.
</div>
<div id="ref-zeger2020" class="csl-entry" role="listitem">
Zeger, S. L., Z. Wu, Y. Coley, A. T. Fojo, B. Carter, K. O’Brien, P. Zandi, et al. 2020. <span>“Using a Bayesian Approach to Predict Patients’ Health and Response to Treatment.”</span> 272. Johns Hopkins Biostatistics Working Paper Series. <a href="https://biostats.bepress.com/jhubiostat/paper272">https://biostats.bepress.com/jhubiostat/paper272</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->

</body>

</html>
