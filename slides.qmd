---
title: "Bayesian Logistic Regression for Predicting Diabetes Risk"
subtitle: |
  NHANES 2013–2014 Analysis  
  
  **Namita Mishra & Autumn Wilcox**\ 
  December 13, 2025
format:
  revealjs:
    theme: simple
    slide-number: true
    transition: fade
    incremental: false
    scrollable: true
    toc: false
    code-overflow: wrap
    code-line-numbers: false
    css: styles.css
execute:
  echo: true
  warning: false
  message: false
  eval: false
bibliography: references.bib
editor: visual

---

## Aim

* Implement Bayesian logistic regression for diabetes prediction.
* Compare Bayesian vs survey-weighted frequentist models.
* Assess population-level burden and subgroup differences.
* Use posterior predictive modeling to evaluate calibration.

---

## Frequentist vs Bayesian Methods

::: panel-tabset

### Frequentist

* Unstable with missing data or quasi-separation.
* Relies on large-sample asymptotics.
* Confidence intervals rely on repeated sampling logic.
* Parameters treated as fixed unknown constants.

### Bayesian

* Probability = degree of belief.
* Incorporates priors → stabilizes estimates.
* Naturally handles missingness and small samples.
* Parameters treated as random variables.
* Produces full posterior distributions.

:::

---

## Bayes’ Theorem

**Posterior = Likelihood × Prior / Evidence**

P(θ | D) = [P(D | θ) × P(θ)] / P(D)

Interpretation:

* **θ:** regression coefficients (age, BMI, sex, race)
* **D:** NHANES data
* **Prior:** reasonable ranges for effect sizes
* **Likelihood:** logistic model
* **Posterior:** updated beliefs after seeing the data

---

## Logistic Link Function

* Uses the logit transformation.
* Translates linear predictor → probability between 0 and 1.
* Predictors: standardized age, standardized BMI, sex, race.

**Interpretation:**
This structure ensures probability predictions stay within meaningful bounds.

---

## Priors

* **Intercept:** Student-t(3, 0, 10)
* **Coefficients:** Normal(0, 2.5)

**Interpretation:**
Weakly informative priors regularize coefficients, preventing extreme estimates in low-information subgroups while still letting the data dominate.

---

## Posterior Distributions

![](figs/prior_posterior.png)

**Interpretation:**
Posterior distributions shift away from the broad priors toward data-supported values, showing strong evidence for age and BMI effects.

---

## Data Source

* NHANES 2013–2014
* Complex multistage probability sampling
* Survey weights required for national inference

---

## Predictor & Outcome Variables

* **Outcome:** DIQ010 (doctor-diagnosed diabetes)
* **Predictors:** RIDAGEYR, BMXBMI, RIAGENDR, RIDRETH1
* Standardization applied to age & BMI

---

## Missing Data & Complete Case

![](figs/str_adult_imp1.png)

**Interpretation:**
Missingness primarily affects BMI; pattern supports MAR. Complete-case analysis reduces sample size but provides a baseline model.

---

## Survey-Weighted Logistic Regression

* Model: diabetes_dx ~ age_c + bmi_c + sex + race
* Weights: WTMEC2YR; PSU + strata for complex design

**Key Results:**

* Age OR ≈ 3.03
* BMI OR ≈ 1.88
* Female OR ≈ 0.53
* Racial/ethnic disparities present

---

## Survey Regression Visualization

![](figs/diabetes_by_race.png)

**Interpretation:**
Non-Hispanic Black and Hispanic groups show elevated predicted diabetes probability compared to White adults after adjustment.

---

## Transition to Bayesian Modeling

* After complete-case frequentist analysis, MICE is used for imputing missing predictors.
* Bayesian model applied to imputed dataset.

---

## MICE Imputation

![](figs/str_adult_imp1.png)

**Interpretation:**
MICE preserves relationships among predictors, reducing complete-case bias and improving model precision.

---

## Bayesian Model Specification

* Formula: diabetes_dx | weights(wt_norm) ~ age_c + bmi_c + sex + race
* Priors: weakly informative
* MCMC: 4 chains, 2000 iterations

---

## MCMC Diagnostics

![](figs/prior_age_bmi.png)

**Interpretation:**
Mixed chains with stable densities and no divergences show strong convergence and reliable sampling.

---

## Posterior Odds Ratios

![](figs/bayes_or.png)

**Interpretation:**
Age and BMI remain strong predictors. Race disparities persist. Female sex slightly protective. Bayesian ORs closely match frequentist results but include fuller uncertainty ranges.

---

## Posterior Draws

![](figs/mcmc_areas.png)

**Interpretation:**
Posterior distributions are well-defined, unimodal, and narrower than priors, indicating strong information from the data.

---

## Prior vs Posterior (Age & BMI)

![](figs/prior_posterior.png)

**Interpretation:**
Posterior distributions shrink considerably, demonstrating how the data updates vague priors.

---

## Posterior Predictive Checks

![](figs/ppc_bars.png)

**Interpretation:**
Observed diabetes frequencies fall within the replicated model distributions — strong evidence of good model fit.

---

## Model Fit — Bayesian R²

![](figs/pred_calibration.png)

**Interpretation:**
Bayesian R² centers around ~0.13. This is expected: diabetes is multifactorial, and a small number of predictors explains modest variance.

---

## Internal Validation

![](figs/posterior_density_participant1.png)

**Interpretation:**
Posterior predictive distribution for an individual reveals uncertainty in personalized diabetes risk, emphasizing probabilistic interpretation.

---

## External Validation

![](figs/pop_vs_posterior_bar.png)

**Interpretation:**
Posterior mean prevalence ≈ 10.95% closely aligns with NHANES’ 8.9%, with overlapping intervals → good calibration.

---

## Reverse Prediction — BMI Threshold

![](figs/inverse_prediction_bmi.png)

**Interpretation:**
Reverse prediction indicates BMI levels associated with a target diabetes probability (e.g., 30%). Results reveal strong influence of age, sex, and race in risk thresholds.

---

## Model Comparison

![](figs/posterior_prevalence_density.png)

**Interpretation:**
Both models agree on direction of effects. Bayesian estimates show mild shrinkage toward zero and richer uncertainty quantification.

---

## Limitations

* Cross-sectional design
* Imputation assumes MAR
* Priors may influence results
* Unmeasured confounding likely

---

## Conclusion

* Frequentist and Bayesian models yield consistent predictors.
* Bayesian approach provides credible intervals and improved uncertainty handling.
* Posterior predictive checks show strong calibration.
* Framework extendable to future cycles and risk prediction tasks.

---

## Thank You

**Advisor:** Dr. Achraf Cohen\
**Presented by:** Namita Mishra & Autumn S. Wilcox\
University of West Florida
