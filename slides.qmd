---
title: "Bayesian Logistic Regression for Predicting Diabetes Risk"
subtitle: |
  NHANES 2013–2014 Analysis  
  
  **Namita Mishra & Autumn Wilcox**\ 
  December 13, 2025
format:
  revealjs:
    theme: simple
    slide-number: true
    transition: fade
    incremental: false
    scrollable: true
    toc: false
    footer: "University of West Florida"
    code-overflow: wrap
    code-line-numbers: false
    css: styles.css
execute:
  echo: true
  warning: false
  message: false
  eval: false
bibliography: references.bib
editor: visual
---

## Introduction

-   **Diabetes mellitus (DM)** affects over 37 million U.S. adults.
-   Key risk factors: **age**, **BMI**, **sex**, and **race/ethnicity**.
-   Traditional logistic regression can yield unstable estimates with missing data or small subgroups.
-   **Bayesian logistic regression** integrates prior information and quantifies uncertainty more transparently.
-   This study compares three frameworks using NHANES 2013–2014 data:
    1.  Survey-weighted logistic regression
    2.  Multiple imputation (MICE)
    3.  Bayesian logistic regression (*brms* in R)

------------------------------------------------------------------------

## Background & Motivation

::: {style="font-size: 0.8em"}
-   **Why Bayesian?**
    -   Traditional logistic regression may yield unstable estimates with missing data or small subgroup sizes.
    -   Bayesian inference incorporates prior information and provides full uncertainty quantification through posterior distributions.
-   **Prior Research**
    -   Bayesian methods have been used successfully in epidemiology to model chronic diseases and improve parameter stability.
    -   Few studies have compared Bayesian and frequentist logistic regression for diabetes using nationally representative data.
-   **Goal**
    -   Evaluate whether Bayesian logistic regression offers improved interpretability and stability compared with frequentist methods using NHANES 2013–2014.
:::

------------------------------------------------------------------------

## Methods — Study Design

-   **Dataset:** NHANES 2013–2014
    -   n = 5,769 adults aged ≥20 years
    -   Variables: age, BMI, sex, race/ethnicity, and doctor-diagnosed diabetes
-   **Survey Design:**
    -   Complex, multistage sampling with strata, clusters, and sample weights
    -   Weights normalized and treated as importance weights in modeling

------------------------------------------------------------------------

## Methods — Dataset Overview

::: {style="font-size: 0.75em"}
-   **Source:** National Health and Nutrition Examination Survey (NHANES) 2013–2014\
-   **Cohort:** 5,769 adults aged ≥20 years\
-   **Merged Components:**
    -   DEMO_H (Demographics)\
    -   BMX_H (Body Measures)\
    -   DIQ_H (Diabetes Questionnaire)
-   **Outcome:** Doctor-diagnosed diabetes (`diabetes_dx`)\
-   **Predictors:**
    -   Age (standardized)\
    -   BMI (standardized)\
    -   Sex (binary: Female vs Male)\
    -   Race/Ethnicity (Non-Hispanic White = reference)
-   **Purpose:** Create a unified analytic dataset suitable for survey-weighted, imputed, and Bayesian logistic regression models.
:::

------------------------------------------------------------------------

## Methods — Data Preparation

-   **Missing Data:**

    -   Addressed using *Multiple Imputation by Chained Equations (MICE)*

-   **Standardization:**

    -   Continuous predictors (age, BMI) converted to z-scores for comparability

-   **Recoding:**

    -   Demographic variables simplified into analysis categories (e.g., race/ethnicity groups, binary sex indicator)

-   **Goal:**

    -   Create a clean, analysis-ready dataset consistent across modeling frameworks

------------------------------------------------------------------------

## Methods — Modeling Workflow
::: {style="font-size: 0.7em"}

::: panel-tabset

### Steps 1-3

Step 1 — Data Acquisition

- NHANES 2013–2014 (DEMO_H, BMX_H, DIQ_H)

- Adults aged ≥20 years (n = 5,769)

- Merged via participant ID `SEQN`

Step 2 — Preprocessing

- Standardized **age** and **BMI**

- Recoded **sex** and **race/ethnicity**

- Created z-scores for comparability

Step 3 — Imputation

- Addressed missingness using *MICE*

- Produced a complete, analysis-ready dataset

### Steps 4-6

Step 4 — Modeling Frameworks

-   **Survey-Weighted Logistic Regression** (design-based MLE)

-   **MICE-Imputed Logistic Regression** (Rubin’s rules)

-   **Bayesian Logistic Regression** (*brms*, Hamiltonian Monte Carlo)

Step 5 — Diagnostics & Evaluation

- \(\hat{R} \approx 1.00\), ESS > 2000

- Posterior predictive checks for calibration

- Bayesian \(R^2 \approx 0.13\)

Step 6 — Interpretation

- Compared coefficients across models

- Identified consistent diabetes predictors

:::

:::

------------------------------------------------------------------------

## Methods — Exploratory Data Analysis (EDA)

::: {style="font-size: 0.8em"}
-   **Missingness**
    -   Low overall: \~3–4% in BMI and diabetes variables\
    -   Addressed via Multiple Imputation by Chained Equations (MICE)
-   **Outcome Distribution**
    -   Diabetes prevalence ≈ 11% among U.S. adults (2013–2014)
-   **Predictor Patterns**
    -   Older adults and higher BMI groups show higher diabetes rates\
    -   Non-Hispanic Black and Hispanic groups have elevated prevalence\
    -   Females slightly lower prevalence than males
-   **Key Takeaway**
    -   The relationships among age, BMI, sex, and race align with prior epidemiologic research, suggesting a sound analytic foundation.
:::

------------------------------------------------------------------------

## Methods — Modeling Framework

**Approaches Compared**

1.  Survey-weighted logistic regression

2.  MICE-imputed logistic regression (Rubin’s rules)

3.  Bayesian logistic regression (*brms*, Hamiltonian Monte Carlo)

**Goal:** Compare coefficient stability, uncertainty quantification, and overall model fit across frameworks.

------------------------------------------------------------------------

::: panel-tabset
### Bayesian Model Code

```{r}
# Bayesian logistic regression using brms
library(brms)

bayes_fit <- brm(
  diabetes_dx ~ age_c + bmi_c + sex + race,
  data = nhanes_imputed,
  family = bernoulli(),
  prior = c(
    prior(normal(0, 2.5), class = "b"),             # slopes
    prior(student_t(3, 0, 10), class = "Intercept") # intercept
  ),
  chains = 4, iter = 2000, warmup = 1000,
  seed = 123
)
```

### Priors & Settings

**Priors**:

-   Slopes: Normal(0, 2.5)

-   Intercept: Student-t(3, 0, 10)

**Sampling**:

-   4 chains × 2000 iterations (1000 warm-up)

**Diagnostics expected**:

-   Rhat ≈ 1.00, ESS \> 2000, Bayesian R² ≈ 0.13

### Diagnostics

```{r}
summary(bayes_fit)                  # coefficient summaries and Rhat
bayes_R2(bayes_fit)                 # Bayesian R²
pp_check(bayes_fit, nsamples = 50)  # posterior predictive check
```
:::

------------------------------------------------------------------------

## Results — Model Comparison

-   All three modeling frameworks identified **the same key predictors** of diabetes risk: higher age, higher BMI, sex, and race/ethnicity.\
-   **Effect sizes** were nearly identical across survey-weighted, MICE-imputed, and Bayesian models.\
-   Minor variation in interval widths reflects different treatments of uncertainty.

------------------------------------------------------------------------

## Results — Model Comparison Summary

::: {style="font-size: 0.8em"}
-   All frameworks identified the same significant predictors: **age, BMI, sex, and race/ethnicity.**

-   Bayesian estimates matched frequentist models in magnitude and direction, confirming robustness.

-   Minor differences in interval width reflect each model’s treatment of uncertainty.

| Predictor | Survey-Weighted OR (95% CI) | MICE-Imputed OR (95% CI) | Bayesian OR (95% CrI) |
|------------------|-------------------|------------------|------------------|
| **Age (per 1 SD)** | 3.02 (2.60–3.54) | 3.01 (2.58–3.50) | 3.00 (2.57–3.48) |
| **BMI (per 1 SD)** | 1.87 (1.66–2.10) | 1.85 (1.64–2.08) | 1.86 (1.65–2.09) |
| **Female (vs Male)** | 0.52 (0.44–0.61) | 0.53 (0.45–0.62) | 0.52 (0.44–0.61) |
| **Non-White (vs NHW)** | 1.40 (1.18–1.66) | 1.42 (1.20–1.68) | 1.41 (1.19–1.67) |
:::

------------------------------------------------------------------------

## Results — Bayesian Performance

-   The Bayesian model showed **excellent convergence and calibration**, with results closely matching the survey-weighted and imputed logistic regressions.
-   Parameter estimates were stable, and credible intervals provided clear uncertainty quantification.

------------------------------------------------------------------------

::: panel-tabset
### Code

```{r}
# Summarize Bayesian model results
summary(bayes_fit)

# Evaluate model fit
bayes_R2(bayes_fit)
```

### Key Findings

-   All Rhat ≈ 1.00 → strong convergence
-   ESS \> 2000 → adequate sampling
-   Bayesian R² = 0.13 → moderate explanatory power
-   Posterior means consistent with frequentist results

### Trace Plots

![](figs/trace_age_bmi.png){width="90%"}
:::

------------------------------------------------------------------------

::: panel-tabset
### Posterior Predictive Check

-   Posterior predictive checks (PPCs) evaluate how well the model reproduces observed data.
-   Here, replicated outcomes from the posterior closely match the observed diabetes prevalence, indicating good model calibration.

### Posterior Plot

![](figs/posterior_dists.png){width="90%"}
:::

------------------------------------------------------------------------

::: panel-tabset
### Code

```{r}
# Posterior predictive check comparing observed vs. simulated outcomes
pp_check(bayes_fit, nsamples = 100) +
  labs(title = "Posterior Predictive Check: Observed vs. Replicated Outcomes")
```

### Plot

![](figs/pp_check.png){width="90%"}

### Interpretation

-   The PPC plot shows the distribution of predicted vs observed outcomes.

-   A strong overlap indicates the Bayesian model fits the observed data well.

-   Simulated outcomes align closely with the observed prevalence of diabetes.

-   Confirms the model is well-calibrated and not overfitting.

-   Supports adequacy of priors and model structure.

-   Reinforces overall reliability of the Bayesian framework.
:::

------------------------------------------------------------------------

## Discussion, Limitations & Conclusion

::: {style="font-size: 0.8em"}
-   **Conclusion:** Bayesian inference complements frequentist methods by enhancing transparency and reproducibility, offering richer uncertainty quantification through credible intervals and PPCs.
-   **Key Findings:** Age and BMI strongest predictors; sex protective; race disparities persistent.\
-   **Consistency:** Bayesian, survey-weighted, and imputed models produced nearly identical results.\
-   **Advantages:** Bayesian approach improved interpretability via credible intervals and PPCs.\
-   **Limitations:** Single imputed dataset, approximate weighting, non-tuned priors, limited to 2013–2014 cycle.\
-   **Conclusion:** Bayesian inference complements frequentist methods by enhancing transparency, uncertainty estimation, and reproducibility.
:::

------------------------------------------------------------------------

## Key Takeaways

-   Consistent results across all three models\
-   Bayesian adds clarity through credible intervals and model diagnostics\
-   Excellent convergence and calibration confirm reliability\
-   Future work: extend to later NHANES cycles and hierarchical priors

------------------------------------------------------------------------

## Future Directions

::: {style="font-size: 0.8em"}
-   **Expand Temporal Scope**
    -   Integrate multiple NHANES cycles to assess changes in diabetes risk over time.
-   **Model Refinement**
    -   Incorporate hierarchical priors to capture subgroup and population-level variation.\
    -   Explore Bayesian model averaging for improved predictive performance.
-   **Validation**
    -   Conduct external validation in independent datasets.\
    -   Perform sensitivity analyses to assess robustness to prior choices and imputation assumptions.
-   **Broader Application**
    -   Extend this framework to related chronic disease outcomes (e.g., hypertension, metabolic syndrome).\
:::

------------------------------------------------------------------------

## Q&A

------------------------------------------------------------------------

### Thank you!
