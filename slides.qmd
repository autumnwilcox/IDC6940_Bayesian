---
title: "Bayesian Logistic Regression for Predicting Diabetes Risk"
subtitle: |
  NHANES 2013–2014 Analysis  
  
  **Namita Mishra & Autumn Wilcox**\ 
  December 13, 2025
format:
  revealjs:
    theme: simple
    slide-number: true
    transition: fade
    incremental: false
    scrollable: true
    toc: false
    footer: "University of West Florida"
    code-overflow: wrap
    code-line-numbers: false
    css: styles.css
execute:
  echo: true
  warning: false
  message: false
  eval: false
bibliography: references.bib
editor: visual
---

## Introduction

-   **Diabetes mellitus (DM)** affects over **37 million U.S. adults**.\
-   Major risk factors include **age**, **BMI**, **sex**, and **race/ethnicity**.\
-   Traditional logistic regression can produce **unstable estimates** with missing data or small subgroups.\
-   **Bayesian logistic regression** addresses these issues by incorporating **prior information** and providing **richer uncertainty estimates**.\
-   This analysis compares three modeling frameworks using **NHANES 2013–2014** data:
    1.  Survey-weighted logistic regression\
    2.  Multiple Imputation by Chained Equations (MICE)\
    3.  Bayesian logistic regression (*brms* in R)

------------------------------------------------------------------------

## Background & Motivation

::: {style="font-size: 0.85em"}
-   **Why Bayesian?**
    -   Traditional logistic regression can produce unstable estimates with missing data or small subgroups.\
    -   Bayesian inference incorporates prior knowledge and fully quantifies uncertainty through posterior distributions.
-   **Prior Research**
    -   Bayesian models have improved parameter stability in epidemiologic studies.\
    -   However, few analyses directly compare Bayesian and frequentist logistic regression for diabetes prediction.
-   **Goal**
    -   Assess whether Bayesian logistic regression improves interpretability and stability compared to frequentist approaches using NHANES 2013–2014 data.
:::

------------------------------------------------------------------------

## Study Design

-   **Dataset:** NHANES 2013–2014
    -   n = 5,769 adults aged ≥20 years\
    -   Variables: age, BMI, sex, race/ethnicity, and doctor-diagnosed diabetes
-   **Survey Design:**
    -   Multistage, complex sampling with strata, clusters, and sample weights\
    -   Weights were normalized and used as importance weights during modeling

------------------------------------------------------------------------

## Dataset Overview

::: {style="font-size: 0.75em"}
-   **Source:** NHANES 2013–2014\

-   **Cohort:** 5,769 adults aged ≥20 years

-   **Merged Components:**

    -   DEMO_H (Demographics)\
    -   BMX_H (Body Measures)\
    -   DIQ_H (Diabetes Questionnaire)

-   **Outcome:** Doctor-diagnosed diabetes (`diabetes_dx`)

-   **Predictors:**

    -   Age (standardized z-score)\
    -   BMI (standardized z-score)\
    -   Sex (Female vs Male)\
    -   Race/Ethnicity (Non-Hispanic White reference group)

-   **Purpose:**\
    Prepare a unified dataset for survey-weighted, imputed, and Bayesian logistic regression models.
:::

------------------------------------------------------------------------

## Data Preparation

-   **Missing Data:**
    -   Handled using *Multiple Imputation by Chained Equations (MICE)*
-   **Standardization:**
    -   Continuous predictors (Age, BMI) converted to z-scores for comparability
-   **Recoding:**
    -   Simplified categorical variables (e.g., binary Sex, grouped Race/Ethnicity)
-   **Goal:**
    -   Produce a clean, standardized dataset for all three modeling frameworks

------------------------------------------------------------------------

## Modeling Workflow

:::: {style="font-size: 0.75em"}
::: panel-tabset
### Steps 1–3: Data Preparation

-   **Step 1 – Acquisition:**
    -   NHANES 2013–2014 (DEMO_H, BMX_H, DIQ_H);
    -   n = 5,769 adults aged ≥20 years
-   **Step 2 – Preprocessing:**
    -   Standardized age & BMI, recoded sex and race/ethnicity
-   **Step 3 – Imputation:**
    -   Addressed missingness using *MICE* to create a complete dataset

### Steps 4–6: Modeling & Evaluation

-   **Step 4 – Modeling Frameworks:**
    -   Survey-weighted logistic regression (design-based MLE)
    -   MICE-imputed logistic regression (Rubin’s rules)
    -   Bayesian logistic regression (*brms*, Hamiltonian Monte Carlo)
-   **Step 5 – Diagnostics:**
    -   R-hat values ≈ 1.00 indicate strong convergence
    -   Effective sample sizes (ESS) \> 2000 confirm sufficient sampling
    -   Posterior predictive checks and Bayesian R² ≈ 0.13 show good model fit
-   **Step 6 – Interpretation:**
    -   Compared parameter estimates across all frameworks
    -   Identified consistent predictors: higher age and BMI increase diabetes risk
    -   Female sex showed a protective effect; race/ethnicity differences remained significant
    -   Bayesian credible intervals provided clear uncertainty quantification
:::
::::

------------------------------------------------------------------------

## Exploratory Data Analysis (EDA)

::: panel-tabset

### Summary
::: {style="font-size: 0.8em"}
-   **Missing Data:**
    -   Low overall (≈3–4%) in BMI and diabetes variables
    -   Addressed using *MICE*
-   **Outcome Distribution:**
    -   Diabetes prevalence ≈ 11% among U.S. adults
-   **Predictor Patterns:**
    -   Higher age and BMI strongly associated with diabetes
    -   Non-Hispanic Black and Hispanic adults show higher prevalence
    -   Females slightly lower prevalence than males
-   **Key Takeaway:**
    -   Observed relationships align with prior epidemiologic research, confirming a solid analytical foundation.
:::

### BMI Distribution
![](figs/bmi_by_diabetes.png){width="80%" fig-align="center" fig-cap="BMI Distribution by Diabetes Status (NHANES 2013–2014)"}

### Race/Ethnicity Distribution
![](figs/diabetes_by_race.png){width="80%" fig-align="center" fig-cap="Diabetes Prevalence by Race/Ethnicity (NHANES 2013–2014)"}

:::

------------------------------------------------------------------------

## Modeling Framework

-   **Survey-Weighted Logistic Regression**
    -   Accounts for NHANES’ complex sampling design (strata, clusters, weights)
-   **MICE-Imputed Logistic Regression**
    -   Combines results across multiple imputations using Rubin’s rules
-   **Bayesian Logistic Regression** (*brms*, Hamiltonian Monte Carlo)
    -   Incorporates prior information and provides full uncertainty quantification

**Goal:**\
Compare coefficient stability, uncertainty estimation, and overall model fit across all three frameworks.

------------------------------------------------------------------------

::: panel-tabset
### Bayesian Model Code

```{r}
# Bayesian logistic regression using brms
library(brms)

bayes_fit <- brm(
  diabetes_dx ~ age_c + bmi_c + sex + race,
  data = nhanes_imputed,
  family = bernoulli(),
  prior = c(
    prior(normal(0, 2.5), class = "b"),             # slopes
    prior(student_t(3, 0, 10), class = "Intercept") # intercept
  ),
  chains = 4, iter = 2000, warmup = 1000,
  seed = 123
)
```

### Priors & Settings

-   **Priors**:

    -   Slopes: Normal(0, 2.5)

    -   Intercept: Student-t(3, 0, 10)

-   **Sampling**:

    -   4 chains × 2000 iterations (1000 warm-up)

-   **Diagnostics Expected**:

    -   Rhat ≈ 1.00, ESS \> 2000, Bayesian R² ≈ 0.13

### Diagnostics Code

```{r}
summary(bayes_fit)                  # coefficient summaries and Rhat
bayes_R2(bayes_fit)                 # Bayesian R²
pp_check(bayes_fit, nsamples = 50)  # posterior predictive check
```
:::

------------------------------------------------------------------------

## Model Comparison

-   **Consistent Predictors Across All Models:**
    -   Higher **age** and **BMI** → increased diabetes risk
    -   **Female sex** → lower odds
    -   **Race/ethnicity** differences persisted
-   **Effect Sizes:**
    -   Nearly identical across survey-weighted, imputed, and Bayesian frameworks
-   **Uncertainty:**
    -   Minor variation in interval widths reflects each model’s uncertainty treatment

------------------------------------------------------------------------

## Model Comparison Summary

::: {style="font-size: 0.8em"}
-   **All frameworks** identified the same significant predictors: **age, BMI, sex, and race/ethnicity.**
-   **Bayesian estimates** matched frequentist models in magnitude and direction, confirming robustness.
-   **Interval widths** varied slightly due to differences in how each framework handles uncertainty.

| Predictor | Survey-Weighted OR (95% CI) | MICE-Imputed OR (95% CI) | Bayesian OR (95% CrI) |
|------------------|-------------------|------------------|------------------|
| **Age (per 1 SD)** | 3.02 (2.60–3.54) | 3.01 (2.58–3.50) | 3.00 (2.57–3.48) |
| **BMI (per 1 SD)** | 1.87 (1.66–2.10) | 1.85 (1.64–2.08) | 1.86 (1.65–2.09) |
| **Female (vs Male)** | 0.52 (0.44–0.61) | 0.53 (0.45–0.62) | 0.52 (0.44–0.61) |
| **Non-White (vs NHW)** | 1.40 (1.18–1.66) | 1.42 (1.20–1.68) | 1.41 (1.19–1.67) |
:::

------------------------------------------------------------------------

## Bayesian Performance

-   **Excellent convergence and calibration**
    -   R-hat values around 1.00 and effective sample sizes above 2000 indicate strong chain mixing and reliable sampling
-   **Stable parameter estimates**
    -   Nearly identical to survey-weighted and imputed models
-   **Credible intervals**
    -   Clearly represent uncertainty and confirm overall model robustness

------------------------------------------------------------------------

::: panel-tabset
### Code

```{r}
# Summarize Bayesian model results
summary(bayes_fit)

# Evaluate model fit
bayes_R2(bayes_fit)
```

### Key Findings

-   All Rhat ≈ 1.00 → strong convergence
-   ESS \> 2000 → adequate sampling
-   Bayesian R² = 0.13 → moderate explanatory power
-   Posterior means consistent with frequentist results

### Trace Plots

![](figs/trace_age_bmi.png){width="90%"}
:::

------------------------------------------------------------------------

::: panel-tabset
### Posterior Predictive Check

-   Posterior predictive checks (PPCs) evaluate how well the model reproduces observed data.
-   Here, replicated outcomes from the posterior closely match the observed diabetes prevalence, indicating good model calibration.

### Posterior Plot

![](figs/posterior_dists.png){width="90%"}
:::

------------------------------------------------------------------------

::: panel-tabset
### Code

```{r}
# Posterior predictive check comparing observed vs. simulated outcomes
pp_check(bayes_fit, nsamples = 100) +
  labs(title = "Posterior Predictive Check: Observed vs. Replicated Outcomes")
```

### Plot

![](figs/pp_check.png){width="90%"}

### Interpretation

-   The PPC plot compares **predicted vs. observed** outcomes.
-   **Strong overlap** between simulated and actual data → good model fit.
-   **Simulated outcomes** accurately reflect real diabetes prevalence.
-   Confirms model is **well-calibrated** and **not overfitting**.
-   Supports adequacy of priors and overall Bayesian structure.
-   Reinforces reliability of the Bayesian framework.
:::

------------------------------------------------------------------------

## Discussion, Limitations & Conclusion

::: {style="font-size: 0.8em"}
-   **Key Findings:** Age and BMI were the strongest predictors; sex was protective; racial disparities persisted.
-   **Consistency:** All three models — Bayesian, survey-weighted, and MICE-imputed — yielded nearly identical results.
-   **Advantages:** The Bayesian approach enhanced interpretability, providing richer uncertainty estimates via credible intervals and PPCs.
-   **Limitations:** Used a single imputed dataset, approximate weighting, and non-tuned priors limited to the 2013–2014 cycle.
-   **Conclusion:** Bayesian inference complements frequentist methods by improving transparency, interpretability, and uncertainty quantification.
:::

------------------------------------------------------------------------

## Key Takeaways

-   Consistent results across all three modeling frameworks
-   Bayesian approach adds clarity through credible intervals and PPCs
-   Strong convergence and calibration confirm reliability
-   Future work: extend to later NHANES cycles and hierarchical priors

------------------------------------------------------------------------

## Future Directions

::: {style="font-size: 0.8em"}
-   **Expand Temporal Scope**
    -   Incorporate additional NHANES cycles to assess temporal trends.
-   **Model Refinement**
    -   Use hierarchical priors to capture subgroup variation.
    -   Explore Bayesian model averaging for improved predictive accuracy.
-   **Validation**
    -   Perform external validation on independent datasets.
    -   Conduct sensitivity analyses for priors and imputation assumptions.
:::

------------------------------------------------------------------------

## Q&A

------------------------------------------------------------------------

### Thank you!
